
    <!DOCTYPE html>
    <html lang="vi">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>ÔN TẬP KT GKI</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700&display=swap" rel="stylesheet">
        <script>
            window.MathJax = {
                tex: {
                    packages: {'[+]': ['ams']},
                    inlineMath: [['$', '$'], ['\\(', '\\)']],
                    displayMath: [['$$', '$$'], ['\\[', '\\]']]
                },
                chtml: {
                    fontCache: 'global',
                    linebreaks: {
                        automatic: true
                    }
                }
            };
        </script>
        <script type="text/javascript" id="MathJax-script" async
            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
        </script>
        <style>
            body { font-family: 'Be Vietnam Pro', sans-serif; background-color: #f0f4f8; }
            .loader { border: 4px solid #f3f3f3; border-top: 4px solid #3b82f6; border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; }
            @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
            .question-card {
                background-color: white;
                border-radius: 1rem;
                padding: 1.5rem 2rem;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
                border-left: 5px solid transparent;
                transition: all 0.3s ease;
            }
            .ai-explanation {
                background-color: #f0f9ff;
                color: #0c4a6e;
                padding: 1rem;
                border-radius: 0.75rem;
                font-size: 0.9rem;
                margin-top: 1rem;
                border-left: 4px solid #38bdf8;
            }
            .feedback-icon { width: 1.5rem; height: 1.5rem; }
            .option-label {
                transition: all 0.2s ease-in-out;
                border: 2px solid #e5e7eb;
            }
            .option-label:hover {
                border-color: #6366f1;
                background-color: #eef2ff;
            }
            .option-label.correct {
                border-color: #10b981 !important;
                background-color: #ecfdf5 !important;
                color: #065f46;
            }
            .option-label.incorrect {
                border-color: #ef4444 !important;
                background-color: #fef2f2 !important;
                color: #991b1b;
            }
            .statement-item.correct { background-color: #ecfdf5; border-color: #10b981; }
            .statement-item.incorrect { background-color: #fef2f2; border-color: #ef4444; }
            .prose { max-width: 100%; }
            .prose h1, .prose h2, .prose h3 { font-weight: 600; }
            .prose p { margin-top: 0.5em; margin-bottom: 0.5em; }
            .prose ul, .prose ol { margin-top: 1em; margin-bottom: 1em; padding-left: 1.5em; }
            .prose li > p { margin-top: 0; margin-bottom: 0; }
            .prose code { background-color: #e5e7eb; padding: 0.2em 0.4em; margin: 0; font-size: 85%; border-radius: 3px; }
            .prose pre { background-color: #e5e7eb; padding: 1em; border-radius: 0.5em; overflow-x: auto; }
            .prose pre code { background-color: transparent; padding: 0; }
            details[open] > summary .details-arrow {
                transform: rotate(180deg);
            }
        </style>
    </head>
    <body class="bg-slate-100 text-slate-800">
        <div id="login-modal" class="fixed inset-0 bg-gray-900 bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4">
            <div class="bg-white p-8 rounded-2xl shadow-2xl w-full max-w-md transform transition-all" style="animation: fadeIn 0.3s ease-out;">
                <h2 class="text-2xl font-bold mb-2 text-center text-slate-800">Thông Tin Học Sinh</h2>
                <p class="text-center text-slate-500 mb-6">Vui lòng nhập để bắt đầu làm bài.</p>
                <form id="student-info-form">
                    <div class="mb-4">
                        <label for="student-name" class="block text-sm font-medium text-slate-700 mb-1">Họ và tên</label>
                        <input type="text" id="student-name" required class="mt-1 block w-full block border border-slate-300 rounded-lg shadow-sm py-2.5 px-3 focus:border-indigo-500 focus:ring-indigo-500">
                    </div>
                    <div class="mb-4">
                        <label for="student-class" class="block text-sm font-medium text-slate-700 mb-1">Lớp</label>
                        <input type="text" id="student-class" required class="mt-1 block w-full border border-slate-300 rounded-lg shadow-sm py-2.5 px-3 focus:border-indigo-500 focus:ring-indigo-500">
                    </div>
                    <div class="mb-4">
                        <label for="exam-code" class="block text-sm font-medium text-slate-700 mb-1">Mã đề</label>
                        <input type="text" id="exam-code" required class="mt-1 block w-full border border-slate-300 rounded-lg shadow-sm py-2.5 px-3 focus:border-indigo-500 focus:ring-indigo-500" placeholder="Nhập mã đề giáo viên cung cấp">
                    </div>
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-slate-700 mb-1">Giáo viên:</label>
                        <p class="mt-1 text-slate-800 bg-slate-100 p-2.5 rounded-lg">HUỲNH BẢO ĐẠI</p>
                    </div>
                    <button type="submit" class="w-full bg-indigo-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-transform transform hover:scale-105">Bắt đầu làm bài</button>
                </form>
            </div>
        </div>
        <div class="container mx-auto p-4 md:p-8 max-w-4xl">
            <header class="mb-10 p-8 rounded-xl bg-gradient-to-r from-blue-500 to-indigo-600 text-white shadow-lg">
                <div class="flex justify-between items-center flex-wrap gap-4">
                    <div>
                        <h1 class="text-4xl font-bold">ÔN TẬP KT GKI</h1>
                        <p class="text-lg text-blue-100 mt-2">Hãy hoàn thành các câu hỏi dưới đây một cách tốt nhất!</p>
                        <p class="text-sm text-blue-200 mt-4">Tác giả: HUỲNH BẢO ĐẠI</p>
                    </div>
                    <div id="timer-container" class="text-right">
                         <div id="timer-display" class="text-3xl font-bold tracking-wider bg-white/20 px-4 py-2 rounded-lg">--:--</div>
                         <div id="retries-display" class="text-sm mt-1 text-blue-200"></div>
                    </div>
                </div>
            </header>
            <main id="student-quiz-container" class="space-y-8 hidden">
                <!-- Questions will be rendered here by JS -->
            </main>
            <footer class="mt-10 text-center">
                <button id="submit-quiz-btn" class="bg-indigo-600 text-white py-3 px-12 rounded-full font-bold text-lg hover:bg-indigo-700 transition-all duration-300 shadow-lg hover:shadow-xl hidden transform hover:scale-105">Nộp Bài</button>
                <div id="result-container" class="mt-6 hidden"></div>
                <div id="ai-feedback-container" class="mt-8 text-left hidden"></div>
                <div id="post-submit-options" class="hidden mt-6 flex flex-col sm:flex-row items-center justify-center gap-4">
                    <button id="retry-quiz-btn" class="w-full sm:w-auto bg-slate-600 text-white py-2.5 px-6 rounded-lg font-semibold hover:bg-slate-700 transition-transform transform hover:scale-105">Làm Lại Đề Này</button>
                </div>
            </footer>
        </div>

        <div id="proctoring-widget" class="fixed bottom-4 right-4 bg-yellow-100 text-yellow-800 p-3 rounded-lg shadow-lg text-sm z-50 hidden border border-yellow-300" style="max-width: 200px;">
            <h4 class="font-bold mb-2 border-b border-yellow-300 pb-1 flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 3.001-1.742 3.001H4.42c-1.53 0-2.493-1.667-1.743-3.001l5.58-9.92zM10 13a1 1 0 110-2 1 1 0 010 2zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" /></svg>
                Giám sát
            </h4>
            <p>Thoát màn hình: <span id="tab-switch-count" class="font-bold">0</span></p>
            <p>Sao chép: <span id="copy-count" class="font-bold">0</span></p>
            <p>Dán: <span id="paste-count" class="font-bold">0</span></p>
        </div>

        <script type="module">
            import { GoogleGenAI, Type } from "https://esm.sh/@google/genai@^1.13.0";
            let quizData = [{"type":"multiple-choice","question":"<strong></strong> Cơ khí chế tạo là ngành kĩ thuật công nghệ sử dụng các kiến thức của Toán học, nguyên lí của Vật lí, các kết quả của công nghệ vật liệu để thực hiện quá trình nào?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Thiết kế, sản xuất và tiêu thụ các sản phẩm dân dụng.","Nghiên cứu, thiết kế, chế tạo, vận hành, bảo dưỡng, sửa chữa các máy, thiết bị, chi tiết.","Khai thác, chế biến và cung ứng vật liệu thô cho các ngành công nghiệp khác.","Lắp ráp và vận hành các dây chuyền sản xuất tự động."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> Đâu là một trong những vai trò quan trọng nhất của Cơ khí chế tạo đối với sản xuất?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Cung cấp nhiên liệu và năng lượng.","Chế tạo ra các công cụ, máy giúp nâng cao năng suất lao động.","Phân phối hàng hóa và sản phẩm tới người tiêu dùng.","Bảo tồn các công nghệ sản xuất truyền thống."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> Đối tượng lao động chính của ngành Cơ khí chế tạo là gì?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Các loại vật liệu hữu cơ và sinh học.","Năng lượng điện và nhiệt.","Các vật liệu cơ khí (kim loại, hợp kim, phi kim loại và vật liệu khác).","Các bản vẽ thiết kế và hồ sơ kĩ thuật."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"<strong></strong> Loại công cụ lao động nào được sử dụng phổ biến trong ngành Cơ khí chế tạo để thực hiện các phương pháp gia công?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Các thiết bị văn phòng và máy tính.","Các công cụ thủ công đơn giản.","Các thiết bị đo lường chính xác.","Các máy công cụ như tiện, phay, bào, hàn."],"optionsImage":[null,null,null,null],"correctAnswerIndex":3},{"type":"multiple-choice","question":"<strong></strong> Theo quy trình chế tạo cơ khí cơ bản, bước đầu tiên cần thực hiện là gì?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Chế tạo phôi.","Đọc bản vẽ chi tiết.","Thực hiện gia công các chi tiết máy.","Lắp ráp và kiểm tra chất lượng sản phẩm."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> Một trong những yêu cầu kĩ thuật cao đối với sản phẩm cơ khí là gì?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Màu sắc và kiểu dáng bắt mắt.","Giá thành sản xuất rẻ.","Trọng lượng nhẹ tuyệt đối.","Độ chính xác kích thước và độ bóng bề mặt."],"optionsImage":[null,null,null,null],"correctAnswerIndex":3},{"type":"multiple-choice","question":"<strong></strong> Mục đích của Bước 4 trong quy trình chế tạo cơ khí (Xử lí và bảo vệ bề mặt của sản phẩm) là gì?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Lắp ráp chi tiết thành sản phẩm hoàn chỉnh.","Kiểm tra lại các đặc tính kĩ thuật sau gia công.","Chống gỉ, chống mài mòn, chịu nhiệt, tăng tính thẩm mĩ.","Nắm được chức năng làm việc và phân loại chi tiết."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"<strong></strong> Hồ sơ kĩ thuật trong ngành Cơ khí chế tạo gồm những thành phần cơ bản nào?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Hợp đồng lao động và chứng từ kế toán.","Các bản vẽ kĩ thuật và quy trình gia công sản phẩm.","Giấy phép kinh doanh và các văn bản pháp lí.","Phiếu nhập kho vật liệu và phiếu xuất kho thành phẩm."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> Vai trò \"Chế tạo ra các công cụ, máy giúp cho lao động trở nên nhẹ nhàng, nâng cao năng suất lao động\" của Cơ khí chế tạo thể hiện sự hiểu biết nào của em?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Công cụ cơ khí chỉ phục vụ cho sản xuất công nghiệp nặng.","Máy móc cơ khí là yếu tố duy nhất quyết định năng suất.","Cơ khí chế tạo chỉ làm ra sản phẩm tiêu dùng.","Sản phẩm cơ khí là phương tiện quan trọng để cơ giới hóa, thay thế sức lao động thủ công."],"optionsImage":[null,null,null,null],"correctAnswerIndex":3},{"type":"multiple-choice","question":"<strong></strong> Bước \"Thực hiện gia công các chi tiết máy của sản phẩm\" (Bước 3) khác biệt cơ bản gì so với bước \"Chế tạo phôi\" (Bước 2)?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Bước 3 chỉ sử dụng phương pháp cắt gọt, còn Bước 2 sử dụng mọi phương pháp.","Bước 2 luôn sử dụng máy CNC, còn Bước 3 chỉ dùng máy truyền thống.","Bước 2 tạo hình ban đầu cho vật liệu, còn Bước 3 gia công để đạt hình dạng, kích thước, độ chính xác yêu cầu.","Bước 3 không cần hồ sơ kĩ thuật, còn Bước 2 cần hồ sơ kĩ thuật."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"<strong></strong> Vì sao các sản phẩm của ngành Cơ khí chế tạo được đánh giá là \"rất phổ biến, có mặt trong tất cả các lĩnh vực của đời sống, xã hội\"?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Vì chúng được sản xuất hàng loạt với giá rất rẻ.","Vì chúng là nền tảng, tạo ra máy móc, thiết bị phục vụ cho mọi ngành nghề (giao thông, y tế, nông nghiệp,...).","Vì chúng chỉ là các đồ dùng, dụng cụ đơn giản trong gia đình.","Vì nguyên liệu chế tạo chúng rất dễ tìm."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> Mục đích chính của Bước 5 (Lắp ráp và kiểm tra chất lượng sản phẩm) trong quy trình chế tạo là gì?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Chỉ để đóng gói sản phẩm trước khi bán ra thị trường.","Hoàn thiện sản phẩm, đảm bảo các chi tiết lắp lại thành một hệ thống hoạt động thống nhất và đáp ứng yêu cầu kĩ thuật.","Chỉ để sửa chữa các sai hỏng phát sinh trong quá trình gia công.","Giúp người thợ học thêm kĩ năng lắp ráp."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> Sự khác biệt cơ bản giữa việc Cơ khí chế tạo chế tạo máy xay sinh tố (Hình 1.2d) và máy gặt đập liên hợp (Hình 1.2c) thể hiện vai trò nào?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Cả hai đều thể hiện vai trò phục vụ nghiên cứu khoa học.","Cả hai đều thể hiện vai trò nâng cao năng suất lao động.","Máy xay sinh tố thể hiện vai trò trong sản xuất, còn máy gặt đập thể hiện vai trò trong đời sống.","Máy xay sinh tố thể hiện vai trò nâng cao chất lượng cuộc sống, máy gặt đập thể hiện vai trò nâng cao năng suất sản xuất."],"optionsImage":[null,null,null,null],"correctAnswerIndex":3},{"type":"multiple-choice","question":"<strong></strong> Vì sao ngành Cơ khí chế tạo luôn đòi hỏi phải có hồ sơ kĩ thuật gồm các bản vẽ và quy trình gia công?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Để làm tăng giá trị thẩm mĩ của sản phẩm.","Để chứng minh sản phẩm đã được đăng kí sở hữu trí tuệ.","Để đảm bảo quá trình sản xuất được thực hiện đúng theo yêu cầu thiết kế và đạt độ chính xác kĩ thuật cao.","Để đơn giản hóa quá trình vận hành máy móc."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"<strong></strong> Theo em, nếu chi tiết máy không đạt được <strong>độ chính xác kích thước</strong> theo yêu cầu, điều gì có khả năng xảy ra nhất?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Chi tiết máy sẽ bị thay đổi màu sắc.","Chi tiết không thể lắp lẫn hoặc không thể hoạt động đồng bộ với các chi tiết khác trong hệ thống máy.","Chi tiết sẽ bị hỏng ngay lập tức trong quá trình gia công.","Chi tiết chỉ dùng được trong các lĩnh vực không cần độ chính xác."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(NB): Ngành nghề trong lĩnh vực cơ khí chế tạo được phân chia thành bao nhiêu nhóm công việc chủ yếu?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["2 nhóm.","3 nhóm.","4 nhóm.","5 nhóm."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(NB): Công việc chủ yếu của nhóm ngành nghề nào đòi hỏi phải có hồ sơ kĩ thuật gồm các bản vẽ kĩ thuật và quy trình lắp ráp sản phẩm?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Thiết kế sản phẩm cơ khí.","Gia công cơ khí.","Lắp ráp sản phẩm cơ khí.","Bảo dưỡng và sửa chữa thiết bị cơ khí."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(NB): Nhóm công việc Thiết kế sản phẩm cơ khí sử dụng các phần mềm nào để hỗ trợ lên phương án thiết kế 3D?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Microsoft Word, Excel.","Solidworks, AutoCAD.","Photoshop, Corel Draw.","SAP2000, Etabs."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(NB): Công việc nào là giai đoạn cuối cùng, mang tính chất chủ yếu của quá trình sản xuất nhằm tổ hợp các chi tiết thành thiết bị hoặc sản phẩm hoàn chỉnh?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Thiết kế sản phẩm cơ khí.","Gia công cơ khí.","Lắp ráp sản phẩm cơ khí.","Bảo dưỡng và sửa chữa thiết bị cơ khí."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(NB): Các phương pháp gia công cơ khí phổ biến nào sau đây không thuộc nhóm gia công cơ khí?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Đúc, rèn, hàn, tiện.","Khoan, phay, bào, cắt laser.","Thiết kế, lập quy trình công nghệ.","Cắt gọt kim loại, dập nóng."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(NB): Công việc nào là nhiệm vụ chính của nhóm ngành nghề Bảo dưỡng, sửa chữa thiết bị cơ khí?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Thiết kế bản vẽ và lập quy trình công nghệ.","Chế tạo chi tiết máy theo yêu cầu kĩ thuật.","Lắp đặt các chi tiết thành sản phẩm hoàn chỉnh.","Kiểm tra tình hình vận hành, ngăn ngừa hỏng hóc, kéo dài tuổi thọ của thiết bị."],"optionsImage":[null,null,null,null],"correctAnswerIndex":3},{"type":"multiple-choice","question":"(NB): Kĩ sư chế tạo máy, còn gọi là kĩ sư cơ khí, là người thực hiện công việc nào sau đây?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Thiết kế, sản xuất, lắp đặt máy móc và bảo trì hệ thống.","Phân tích các chi tiết máy đã gia công.","Chỉ chuyên về bảo dưỡng các máy móc tự động.","Chuyên về lĩnh vực vật liệu phi kim loại."],"optionsImage":[null,null,null,null],"correctAnswerIndex":0},{"type":"multiple-choice","question":"(NB): Người thực hiện nhóm công việc Gia công cơ khí đòi hỏi phải có các năng lực chuyên môn như:","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Thiết kế 3D, tính toán kết cấu.","Phân tích, xử lí các sự cố hỏng hóc.","Cắt gọt kim loại, hàn, rèn dập.","Lập bảng kiểm tra lắp ráp sản phẩm."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(TH): Sự khác biệt cốt lõi giữa nhóm công việc Thiết kế sản phẩm cơ khí và nhóm Gia công cơ khí là gì?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Thiết kế sử dụng máy tính, Gia công sử dụng máy công cụ.","Thiết kế sử dụng Toán học, Gia công sử dụng Vật lí.","Thiết kế là giai đoạn tạo ra hồ sơ kĩ thuật, Gia công là giai đoạn tạo ra chi tiết máy.","Thiết kế tạo ra sản phẩm, Gia công sửa chữa sản phẩm."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(TH): Tại sao nhóm ngành nghề Bảo dưỡng, sửa chữa thiết bị cơ khí cần phải được thực hiện một cách thường xuyên?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Để nâng cao năng suất sản xuất của nhà máy.","Để kịp thời phát hiện ra các sai hỏng nhằm duy trì sự hoạt động ổn định và kéo dài tuổi thọ của thiết bị.","Để thay đổi quy trình công nghệ cho phù hợp với xu hướng mới.","Để giảm bớt chi phí nhân công cho quá trình sản xuất."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(TH): Việc sử dụng các phần mềm thiết kế 3D (Solidworks, AutoCAD) trong công việc Thiết kế sản phẩm cơ khí có vai trò quan trọng nhất là gì?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Giúp người thiết kế không cần kiến thức Toán học, Vật lí.","Tăng tốc độ trong việc truyền đạt ý tưởng thiết kế, kiểm tra tính toán và thay đổi dễ dàng.","Chỉ dùng để in ấn bản vẽ 2D.","Thay thế hoàn toàn cho các kĩ sư có kinh nghiệm."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(TH): Công việc Gia công cơ khí cần tuân thủ hồ sơ kĩ thuật (bản vẽ) chủ yếu nhằm mục đích gì?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Đảm bảo người thợ có việc làm.","Đảm bảo chi tiết máy được chế tạo đạt yêu cầu kĩ thuật về kích thước, hình dạng, độ bóng bề mặt.","Đảm bảo sử dụng tất cả các máy công cụ hiện có.","Đảm bảo sản phẩm có màu sắc đẹp."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(TH): Tại sao nói công việc Lắp ráp sản phẩm cơ khí là khâu trung gian, cầu nối giữa Gia công cơ khí và Bảo dưỡng - Sửa chữa?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Vì nó là giai đoạn cuối cùng của sản xuất.","Vì nó là giai đoạn chuyển tiếp từ chi tiết sang sản phẩm hoàn chỉnh, và sản phẩm hoàn chỉnh sẽ được đưa vào bảo dưỡng.","Vì nó đòi hỏi cả kỹ năng thiết kế và gia công.","Vì nó không cần tuân thủ hồ sơ kĩ thuật."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(NB): Vật liệu cơ khí là gì?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Là vật liệu chỉ dùng để chế tạo chi tiết máy trong các máy móc công nghiệp.","Là vật liệu chỉ gồm kim loại và hợp kim.","Là vật liệu được sử dụng trong sản xuất cơ khí để tạo nên các sản phẩm như thiết bị, máy móc.","Là vật liệu được dùng chủ yếu trong xây dựng và kĩ thuật điện."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(NB): Yêu cầu nào sau đây thuộc về tính sử dụng của vật liệu cơ khí?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Khả năng đúc, hàn, cắt gọt dễ dàng.","Giá thành sản xuất phải thấp nhất.","Độ bền, độ cứng, tính dẫn điện, hay khả năng chống ăn mòn hóa học.","Khả năng tái chế sau khi hết tuổi thọ."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(NB): Trong sản xuất cơ khí, nhóm vật liệu nào được sử dụng chủ yếu nhất?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Vật liệu phi kim loại (chất dẻo, cao su).","Vật liệu kim loại và hợp kim (sắt, đồng, nhôm).","Vật liệu mới (composite, nano).","Vật liệu gốm sứ kĩ thuật."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(NB): Yêu cầu nào sau đây thuộc về tính công nghệ của vật liệu cơ khí?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Độ bền cơ học cao.","Khả năng gia công bằng các phương pháp như đúc, hàn, cắt gọt.","Giá thành thấp.","Khả năng chống cháy."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(NB): Vật liệu nào sau đây là ví dụ của vật liệu phi kim loại được dùng phổ biến trong ngành cơ khí?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Thép carbon.","Hợp kim đồng.","Cao su.","Hợp kim nhôm."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(NB): Tính kinh tế của vật liệu cơ khí yêu cầu điều gì?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Vật liệu phải có độ bền tuyệt đối.","Vật liệu phải có khả năng chống ăn mòn.","Giá thành thấp nhưng vẫn đáp ứng được các yêu cầu về tính công nghệ và tính sử dụng.","Vật liệu phải dễ dàng được tái chế."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(NB): Vật liệu nào sau đây được phân loại là vật liệu mới trong cơ khí chế tạo?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Hợp kim Gang.","Thép không gỉ.","Composite.","Nhôm nguyên chất."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(NB): Mục đích của việc sử dụng vật liệu phi kim loại trong máy móc hiện nay là gì?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Tăng tính dẫn điện cho sản phẩm.","Thay thế một phần kim loại vì chúng có khả năng cách điện và chịu ăn mòn hóa học.","Giảm độ cứng tuyệt đối của sản phẩm.","Tăng giá thành sản xuất."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(TH): Tại sao nói vật liệu cơ khí là vật liệu có tính đa dạng và tính tương đối?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Vì chúng luôn có giá thành rất cao.","Vì chúng chỉ có tính chất cơ học.","Vì nhiều loại vật liệu (kim loại, chất dẻo,...) không chỉ dùng trong cơ khí mà còn dùng trong nhiều lĩnh vực khác (xây dựng, điện).","Vì chúng chỉ có thể được gia công bằng phương pháp đúc."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(TH): Nếu một vật liệu có độ bền cơ học (tính sử dụng) rất cao, nhưng lại rất khó cắt gọt, khó đúc (tính công nghệ kém), thì điều gì sẽ xảy ra?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Sản phẩm cuối cùng chắc chắn sẽ đạt chất lượng tuyệt đối.","Chi phí và thời gian sản xuất sẽ tăng lên đáng kể, làm giảm tính kinh tế.","Vật liệu này không thể sử dụng được trong bất kì lĩnh vực nào.","Vật liệu sẽ không cần phải bảo dưỡng."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(TH): Tính chất nào sau đây của vật liệu không phải là tính chất cơ học?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Độ bền (chịu tải trọng).","Độ cứng (chống lại sự biến dạng).","Tính dẫn nhiệt.","Độ dẻo (khả năng biến dạng mà không bị phá hủy)."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(TH): Yêu cầu về Tính công nghệ giúp giải quyết vấn đề gì trong quá trình sản xuất?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Giúp sản phẩm chịu lực tốt hơn khi làm việc.","Giúp tăng giá thành của sản phẩm.","Giúp giảm độ khó khi chế tạo, đảm bảo năng suất và chất lượng gia công.","Giúp vật liệu chống ăn mòn hóa học."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(TH): Đặc điểm nào là nổi bật nhất của vật liệu mới (composite, nano, polymer tiên tiến) so với vật liệu kim loại và phi kim loại truyền thống?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Chúng có giá thành rẻ hơn rất nhiều.","Chúng hoàn toàn không bị ăn mòn.","Chúng có tính chất cơ học vượt trội và kết quả có thể được kiểm soát bởi các kích thích bên ngoài (ứng suất, nhiệt độ...).","Chúng chỉ được dùng để chế tạo các bộ phận không chịu lực."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(TH): Việc lựa chọn vật liệu cho một chi tiết máy là sự cân bằng giữa các yêu cầu nào?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Kim loại và phi kim loại.","Vật liệu mới và vật liệu truyền thống.","Tính sử dụng, tính công nghệ và tính kinh tế.","Tính dẫn điện và tính dẫn nhiệt."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(TH): Tại sao vật liệu composite, mặc dù có giá thành vật liệu thô cao hơn thép, vẫn được ưa chuộng trong ngành hàng không?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Vì nó có thể dễ dàng cắt gọt hơn thép.","Vì tỉ lệ độ bền trên khối lượng (độ bền riêng) của nó cao hơn thép, giúp giảm trọng lượng máy bay, tiết kiệm nhiên liệu.","Vì nó có khả năng dẫn điện tốt hơn thép.","Vì nó có thể được đúc nhanh hơn thép."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(NB): Nhóm vật liệu kim loại và hợp kim được chia làm mấy loại chính?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["2 loại.","3 loại.","4 loại.","5 loại."],"optionsImage":[null,null,null,null],"correctAnswerIndex":0},{"type":"multiple-choice","question":"(NB): Hợp kim nào sau đây thuộc nhóm kim loại đen?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Đồng thau.","Hợp kim nhôm.","Gang.","Titan."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(NB): Kim loại màu phổ biến nào sau đây có tính dẻo, dễ dát mỏng, dễ kéo sợi, và là vật liệu dẫn điện, dẫn nhiệt rất tốt, chỉ đứng sau bạc?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Nhôm.","Titan.","Đồng.","Kẽm."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(NB): Thép là hợp kim của sắt và carbon, với hàm lượng carbon là bao nhiêu?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Lớn hơn 2,14%.","Nhỏ hơn 2,14%.","Từ 2,14% đến 6,67%.","Lớn hơn 6,67%."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(NB): Hợp kim nhôm có khối lượng riêng nhỏ, có khả năng chống ăn mòn tốt và có màu trắng ánh kim. Ứng dụng phổ biến của hợp kim nhôm là gì?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Chế tạo các chi tiết chịu mài mòn cao.","Chế tạo chi tiết cần độ cứng tuyệt đối.","Chế tạo vỏ và thân các phương tiện giao thông (ô tô, máy bay).","Chế tạo các bộ phận động cơ cần chịu nhiệt cao."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(NB): Nguyên tố nào sau đây là thành phần chính của hợp kim Đồng thau (Brass)?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Nhôm (Al).","Kẽm (Zn).","Thiếc (Sn).","Niken (Ni)."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(NB): Gang là hợp kim của sắt và carbon, với hàm lượng carbon nằm trong khoảng nào?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Nhỏ hơn 2,14%.","Từ 2,14% đến 6,67%.","Lớn hơn 6,67%.","Từ 0,02% đến 0,8%."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(NB): Đặc điểm nổi bật nhất của Titan và hợp kim Titan là gì?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Tính dẫn điện, dẫn nhiệt rất tốt.","Độ bền cao, khối lượng riêng nhỏ, và chống ăn mòn tuyệt vời.","Có tính đúc tốt.","Giá thành rẻ, dễ gia công."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(TH): Vì sao Gang được sử dụng rộng rãi trong chế tạo các chi tiết có hình dạng phức tạp (như thân máy, vỏ động cơ)?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Vì Gang rất dẻo và dễ kéo sợi.","Vì Gang có độ bền cao hơn Thép hợp kim.","Vì Gang có tính đúc tốt (khả năng nóng chảy và điền đầy khuôn tốt).","Vì Gang có tính chống gỉ tuyệt đối."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(TH): Điểm khác biệt cốt lõi nào khiến Thép được sử dụng để chế tạo các chi tiết chịu lực và chịu va đập, trong khi Gang chỉ dùng cho các chi tiết ít chịu tải?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Thép rẻ hơn Gang.","Thép có tính dẻo và độ bền cơ học cao hơn Gang (do hàm lượng carbon thấp hơn).","Thép chống ăn mòn tốt hơn Gang.","Thép nhẹ hơn Gang."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(TH): Hợp kim nào sau đây được gọi là Đồng thanh (Bronze)?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Hợp kim Đồng và Kẽm.","Hợp kim Đồng và Niken.","Hợp kim Đồng và Thiếc.","Hợp kim Đồng và Nhôm."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(TH): Tại sao Thép hợp kim (Steel Alloy) lại được sử dụng phổ biến hơn Thép Carbon (Carbon Steel) trong chế tạo các chi tiết yêu cầu cao (dụng cụ cắt, ổ lăn)?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Thép Carbon có giá thành cao hơn.","Thép hợp kim có các tính chất cơ học, vật lí, hóa học vượt trội hơn nhờ được bổ sung các nguyên tố hợp kim (Cr, Ni, Mn,...).","Thép Carbon không thể nhiệt luyện.","Thép hợp kim dễ gia công cắt gọt hơn."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(TH): Hợp kim Nhôm có khối lượng riêng nhỏ hơn Gang và Thép rất nhiều. Điều này mang lại lợi ích gì lớn nhất cho ngành công nghiệp ô tô?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Tăng tính công nghệ của vật liệu.","Giảm chi phí sản xuất phôi.","Giảm trọng lượng tổng thể của xe, từ đó tiết kiệm nhiên liệu và tăng hiệu suất vận hành.","Tăng độ cứng tuyệt đối cho xe."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(TH): Tính chất nào của Đồng thau khiến nó được ứng dụng rộng rãi để chế tạo các chi tiết trang trí, mỹ nghệ, hoặc các bộ phận máy bơm trong môi trường nước biển?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Tính dẫn điện tốt.","Màu sắc đẹp, chống ăn mòn hóa học (đặc biệt trong môi trường ẩm ướt, nước biển).","Độ cứng rất cao.","Khả năng chịu nhiệt tuyệt đối."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(TH): Thép carbon được phân loại dựa trên hàm lượng carbon của nó. Việc phân loại này có ý nghĩa gì đối với người thợ cơ khí?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Chỉ để phân biệt màu sắc của thép.","Giúp xác định tính chất cơ học (độ cứng, độ bền) và chọn phương pháp gia công, nhiệt luyện phù hợp.","Giúp xác định giá thành sản phẩm.","Giúp xác định khối lượng riêng."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(NB): Vật liệu phi kim loại (hay còn gọi là vật liệu không kim loại) được phân loại thành những nhóm chính nào?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Nhựa nhiệt dẻo, Nhựa nhiệt cứng, Cao su.","Nhựa, Cao su, Gốm.","Nhựa nhiệt dẻo, Cao su tự nhiên, Cao su tổng hợp.","Vật liệu hữu cơ, Vật liệu vô cơ."],"optionsImage":[null,null,null,null],"correctAnswerIndex":0},{"type":"multiple-choice","question":"(NB): Vật liệu phi kim loại nào sau đây là hợp chất cao phân tử, khi nung nóng sẽ chảy lỏng và khi làm nguội lại rắn, quá trình này có thể lặp lại nhiều lần?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Nhựa nhiệt rắn.","Nhựa nhiệt dẻo.","Cao su thiên nhiên.","Cao su tổng hợp."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(NB): Nhựa nhiệt rắn (thermoset plastic) có đặc điểm nổi bật nào về nhiệt độ?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Nhiệt độ nóng chảy thấp.","Có thể nóng chảy và tái chế dễ dàng.","Không nóng chảy hay chảy loãng khi nung nóng lần thứ hai.","Chỉ nóng chảy ở nhiệt độ phòng."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(NB): Cao su có tính chất đặc trưng nào mà hầu hết các vật liệu kim loại và phi kim loại khác không có được?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Khả năng chịu nhiệt tuyệt đối.","Tính dẫn điện, dẫn nhiệt tốt.","Độ đàn hồi cao (có thể kéo dài tới 700% đến 800% mà không giảm chất lượng).","Khả năng chống ăn mòn hóa học mạnh."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(NB): Phương pháp gia công chủ yếu nào thường được dùng cho vật liệu Nhựa nhiệt dẻo?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Đúc.","Đùn, phun, thổi, ép.","Hàn.","Cắt gọt."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(NB): Đặc điểm nổi bật của vật liệu phi kim loại so với kim loại về tính chất cơ học là gì?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Có độ bền, độ cứng và tính dẻo cao hơn.","Có tính dẫn điện, dẫn nhiệt tốt hơn.","Có khối lượng riêng lớn hơn.","Có độ bền, độ cứng, tính dẻo và tính đàn hồi thấp hơn."],"optionsImage":[null,null,null,null],"correctAnswerIndex":3},{"type":"multiple-choice","question":"(NB): Loại vật liệu nào sau đây được dùng để làm săm, lốp, ống dẫn, các phần tử đàn hồi của khớp, trục, đai truyền trong ngành cơ khí?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Nhựa nhiệt dẻo.","Nhựa nhiệt rắn.","Cao su.","Thủy tinh."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(NB): Phương pháp đơn giản nào sau đây không được dùng để nhận biết tính chất cơ bản của vật liệu phi kim loại?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Quan sát đặc trưng quang học.","Xác định khối lượng riêng.","Phá hủy của mẫu khi chịu tác động cơ học.","Quan sát màu sắc và mặt gãy (chỉ áp dụng cho kim loại)."],"optionsImage":[null,null,null,null],"correctAnswerIndex":3},{"type":"multiple-choice","question":"(TH): Tại sao Nhựa nhiệt dẻo được ứng dụng rộng rãi để chế tạo bánh răng, ốc vít trong máy móc, thiết bị?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Vì nó có khả năng dẫn điện tốt.","Vì nó có độ cứng tuyệt đối.","Vì nó có khả năng chống oxi hóa, không bị ăn mòn và dễ gia công tạo hình.","Vì nó không bị ảnh hưởng bởi nhiệt độ."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(TH): Đặc điểm về tính chất vật lí nào của vật liệu phi kim loại khiến chúng ít được dùng trong các bộ phận máy móc chịu nhiệt cao, áp suất lớn?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Tính dẫn điện tốt.","Nhiệt độ nóng chảy thấp và dễ bị phân hủy khi nhiệt độ tăng.","Khối lượng riêng quá lớn.","Độ bền riêng cao."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(TH): Sự khác biệt cốt lõi giữa Nhựa nhiệt dẻo và Nhựa nhiệt rắn là gì?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Nhựa nhiệt rắn nhẹ hơn.","Nhựa nhiệt dẻo chống ăn mòn tốt hơn.","Cấu trúc phân tử (Nhựa nhiệt dẻo không gian thay đổi, Nhựa nhiệt rắn cố định sau lần gia công nhiệt đầu tiên).","Nhựa nhiệt rắn có màu trong suốt."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(TH): Tính chất hóa học nào của vật liệu phi kim loại (như nhựa, cao su) mang lại lợi ích lớn trong môi trường ẩm ướt hoặc hóa chất nhẹ?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Khả năng oxi hóa mạnh.","Không bị oxi hóa, không bị ăn mòn bởi môi trường acid, muối, kiềm thông thường.","Có khả năng tự phân hủy sinh học.","Dễ bị hòa tan."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(TH): Việc xác định khối lượng riêng (ví dụ: dao động từ 0,9 g.cm3 đến 2 g.cm3) của vật liệu phi kim loại có ý nghĩa gì?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Giúp xác định khả năng chống ăn mòn.","Giúp xác định màu sắc của vật liệu.","Giúp so sánh mức độ nặng nhẹ giữa các loại vật liệu và ứng dụng (ví dụ: vật liệu nhẹ dùng cho ngành hàng không).","Giúp xác định nhiệt độ nóng chảy."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(TH): Tại sao cao su thiên nhiên thường được chế biến thành cao su nhân tạo (cao su tổng hợp) để sử dụng trong công nghiệp?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Vì cao su thiên nhiên quá rẻ.","Vì cao su nhân tạo có độ bền, độ cứng, khả năng chịu nhiệt và chống ăn mòn tốt hơn.","Vì cao su thiên nhiên không có tính đàn hồi.","Vì cao su nhân tạo có màu sắc đẹp hơn."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(TH): Trong ngành điện, người ta thường dùng nhựa nhiệt dẻo như PVC, PE để bọc dây điện. Tính chất nào là quan trọng nhất ở đây?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Chịu lực tốt.","Chống gỉ sét.","Không dẫn điện (cách điện) và chống thấm nước.","Màu sắc đẹp."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(NB): Vật liệu Composite được cấu tạo từ mấy thành phần chính?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Một thành phần.","Hai thành phần.","Ba thành phần.","Bốn thành phần."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(NB): Vật liệu nào sau đây đóng vai trò liên kết các thành phần khác lại với nhau trong Vật liệu Composite?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Vật liệu cốt.","Vật liệu nền (Matrix).","Sợi thủy tinh.","Hạt Nano."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(NB): Vật liệu cốt (reinforcement) trong Vật liệu Composite có vai trò chủ yếu là gì?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Chống ăn mòn hóa học.","Tăng tính dẻo.","Tăng độ bền cơ học và độ cứng cho vật liệu.","Giảm khối lượng riêng."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(NB): Vật liệu Nano là vật liệu có kích thước hạt nhỏ hơn bao nhiêu mét (m)?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["1 mm.","$1 \\text{ \\textmu m}$.","100 nm (hoặc 10−7 m).","1 nm."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(NB): Các loại sợi nào sau đây thường được dùng làm vật liệu cốt cho Composite nền Polymer (FRP)?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Sợi Đồng, Sợi Nhôm.","Sợi Thủy tinh, Sợi Carbon.","Sợi Cao su, Sợi Kẽm.","Sợi Vải, Sợi Tre."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(NB): Tính chất nào sau đây là đặc điểm nổi bật nhất của Vật liệu Composite so với kim loại truyền thống?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Tính dẫn điện tuyệt đối.","Tỉ lệ độ bền trên khối lượng (độ bền riêng) cao.","Khả năng tái chế dễ dàng.","Nhiệt độ nóng chảy rất cao."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(NB): Ứng dụng phổ biến nhất của vật liệu Nano trong y học là gì?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Chế tạo khung máy MRI.","Dẫn thuốc đặc trị đến các tế bào ung thư hoặc khu vực bị bệnh.","Chế tạo giường bệnh.","Chế tạo dụng cụ phẫu thuật cơ học."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(NB): Đặc điểm nào sau đây là nhược điểm của Vật liệu Composite?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Khối lượng riêng lớn.","Khó kiểm tra chất lượng và khó sửa chữa khi bị hư hỏng.","Tính dẫn điện kém.","Chịu ăn mòn hóa học kém."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(TH): Nếu Vật liệu Composite sử dụng nền là Gốm (Ceramic Matrix Composite - CMC), thì mục đích chính của việc này là gì?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Giảm giá thành sản xuất.","Tăng tính dẻo, dễ uốn.","Tăng khả năng chịu nhiệt độ rất cao và chịu mài mòn.","Tăng tính dẫn điện."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(TH): Tại sao Vật liệu Composite được xem là vật liệu lí tưởng cho ngành Hàng không và Công nghiệp Vũ trụ?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Vì nó có giá thành rẻ hơn Nhôm và Titan.","Vì nó có tính đàn hồi cao như cao su.","Vì nó có độ bền cơ học cao, chịu tải tốt, đồng thời khối lượng riêng nhỏ (nhẹ), giúp tiết kiệm nhiên liệu.","Vì nó có khả năng dẫn điện tuyệt đối."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"(TH): Sự thay đổi tính chất cơ học (độ cứng, độ bền) của vật liệu ở kích thước Nano so với vật liệu ở kích thước khối lớn (Bulk Material) là do đâu?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Do nhiệt độ nóng chảy tăng lên.","Do tỉ lệ diện tích bề mặt trên thể tích tăng lên đột ngột.","Do vật liệu chuyển sang trạng thái lỏng.","Do vật liệu Nano chỉ làm từ kim loại."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(TH): Trong Vật liệu Composite, nếu vật liệu nền là Kim loại (Metal Matrix Composite - MMC), chi tiết tạo ra sẽ phù hợp với ứng dụng nào nhất?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Chi tiết cần cách điện tuyệt đối.","Chi tiết cần chịu nhiệt độ cao và độ bền mỏi tốt hơn so với Composite nền Polymer.","Chi tiết cần tính dẻo cao và dễ tái chế.","Chi tiết cần độ đàn hồi lớn."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(TH): Lớp phủ Nano (Nanocoating) được ứng dụng trên các chi tiết cơ khí (như dụng cụ cắt gọt, ổ bi) chủ yếu nhằm mục đích gì?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Giảm chi phí sản xuất dụng cụ.","Tăng độ cứng, khả năng chống mài mòn và giảm ma sát của bề mặt.","Giúp chi tiết trở nên dẻo hơn.","Tăng tính dẫn điện của dụng cụ."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(TH): Vật liệu Composite sợi Carbon (CFRP) có giá thành cao hơn Composite sợi Thủy tinh (GFRP). Điều này chủ yếu là do sự khác biệt nào về tính chất?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["GFRP có khả năng chống ăn mòn hóa học tốt hơn.","CFRP có độ bền và độ cứng vượt trội, và khối lượng riêng nhỏ hơn.","GFRP có tính cách điện tốt hơn.","CFRP dễ gia công hơn."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"(TH): Việc sử dụng Vật liệu Composite đã giải quyết được vấn đề cơ bản nào của vật liệu truyền thống?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Khả năng tái chế.","Tính không đồng nhất trong tính chất (kết hợp các ưu điểm của vật liệu nền và vật liệu cốt).","Độ bền cơ học kém.","Khối lượng riêng lớn."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"true-false","question":null,"main_question":"<strong></strong> <strong>Trong quy trình chế tạo cơ khí một chi tiết máy, hãy xác định tính đúng.sai của các nhận định sau:</strong>","questionImage":null,"mappedType":"true-false","statements":[{"statement":" Cơ khí chế tạo là ngành kĩ thuật công nghệ sử dụng kiến thức Toán học, Vật lí, công nghệ vật liệu.","is_correct":true},{"statement":"Vai trò của cơ khí chế tạo chỉ giới hạn trong việc sản xuất máy móc phục vụ công nghiệp nặng.","is_correct":false},{"statement":"Bước \"Thực hiện gia công các chi tiết máy\" có mục đích tạo ra hình dáng sơ bộ của chi tiết, không cần độ chính xác cao.","is_correct":false},{"statement":"Khi lắp ráp xong chi tiết máy vào máy hoàn chỉnh, cần phải kiểm tra lại các đặc tính kĩ thuật của chi tiết trước khi đưa vào hoạt động.","is_correct":true}]},{"type":"true-false","question":null,"main_question":"<strong></strong> <strong>Về đặc điểm và yêu cầu của ngành Cơ khí chế tạo, hãy xác định tính đúng.sai của các nhận định sau:</strong>","questionImage":null,"mappedType":"true-false","statements":[{"statement":"</strong> Phần lớn sản phẩm của ngành Cơ khí chế tạo là các đồ dùng, dụng cụ gia đình tiện nghi.","is_correct":false},{"statement":"Để sản xuất sản phẩm, ngành Cơ khí chế tạo không cần hồ sơ kĩ thuật phức tạp như bản vẽ hay quy trình gia công.","is_correct":false},{"statement":"Công đoạn lựa chọn vật liệu và phương pháp tạo phôi (đúc, hàn, rèn,...) được thực hiện sau khi gia công cắt gọt chi tiết.","is_correct":false},{"statement":"Để giảm thiểu chi phí và thời gian sản xuất, người kĩ sư có thể cắt giảm yêu cầu về độ bóng bề mặt của chi tiết máy.","is_correct":true}]},{"type":"true-false","question":null,"main_question":"<strong></strong> <strong>Phân tích các vai trò của Cơ khí chế tạo trong đời sống, hãy xác định tính đúng.sai của các nhận định sau:</strong>","questionImage":null,"mappedType":"true-false","statements":[{"statement":"Cơ khí chế tạo là tiền đề và nền tảng cho sự phát triển của hầu hết các ngành kinh tế khác (công nghiệp, nông nghiệp, giao thông).","is_correct":true},{"statement":"Việc chế tạo ra máy bay, tàu hỏa đã giúp cuộc sống của con người trở nên tiện nghi và thú vị hơn.","is_correct":true},{"statement":"Độ chính xác kích thước và độ bóng bề mặt cao là yêu cầu bắt buộc vì chúng ảnh hưởng trực tiếp đến tuổi thọ và hiệu suất làm việc của chi tiết máy.","is_correct":true},{"statement":"Việc sử dụng robot trong sản xuất cơ khí giúp loại bỏ hoàn toàn vai trò của con người trong quá trình sản xuất.","is_correct":false}]},{"type":"true-false","question":null,"main_question":"<strong></strong> <strong>Về các bước trong quy trình chế tạo cơ khí, hãy xác định tính đúng.sai của các nhận định sau:</strong>","questionImage":null,"mappedType":"true-false","statements":[{"statement":"*<strong>a)</strong> Bước 3 là Thực hiện gia công các chi tiết máy, bao gồm các hoạt động như cắt, gọt, lắp, kiểm tra,...","is_correct":true},{"statement":"Bước 5 (Lắp ráp và kiểm tra) có thể được bỏ qua nếu các chi tiết đã được gia công với độ chính xác rất cao.","is_correct":false},{"statement":"Bước 2 (Chế tạo phôi) chỉ sử dụng duy nhất phương pháp đúc để tạo hình dạng sơ bộ cho vật liệu.","is_correct":false},{"statement":"Bước 4 (Xử lí và bảo vệ bề mặt) không chỉ để bảo vệ mà còn để tạo tính chất mới (như tính dẫn điện, chịu nhiệt) cho chi tiết máy.","is_correct":true}]},{"type":"true-false","question":null,"main_question":"<a id=\"Xbc8d9270749a35bcda748b86d699f41092259ca\"></a> Các nhóm công việc và yêu cầu (2NB, 1TH, 1VD)<br>Câu dẫn: Nhận định nào dưới đây là ĐÚNG khi nói về các nhóm công việc trong lĩnh vực cơ khí chế tạo?","questionImage":null,"mappedType":"true-false","statements":[{"statement":"Công việc Bảo dưỡng và sửa chữa thiết bị cơ khí là nhiệm vụ kiểm tra và xử lí hư hỏng thiết bị, nhưng không cần phải hiểu rõ nguyên lí hoạt động của thiết bị cơ khí. (Nhận biết)","is_correct":false},{"statement":"Các nghề thuộc nhóm Gia công cơ khí chủ yếu thực hiện các phương pháp gia công cơ khí như tiện, phay, hàn, bào. (Nhận biết)","is_correct":true},{"statement":"Thiết kế sản phẩm cơ khí chỉ là việc vẽ các bản vẽ kĩ thuật 2D mà không cần đến tính toán kinh tế hay công nghệ vật liệu. (Thông hiểu)","is_correct":false},{"statement":"Khi thực hiện công việc Lắp ráp sản phẩm cơ khí, nếu phát hiện ra một chi tiết bị sai lệch kích thước so với bản vẽ, người kĩ thuật viên nên tự ý sửa chữa chi tiết đó để tiết kiệm thời gian. (Vận dụng)","is_correct":false}]},{"type":"true-false","question":null,"main_question":"<a id=\"Xd8397fa6e59c06e0834e74591791322e1f33535\"></a> Các nghề nghiệp và công cụ (2NB, 1TH, 1VD)<br>Câu dẫn: Hãy đánh giá tính ĐÚNG.SAI của các nhận định sau về các ngành nghề trong lĩnh vực cơ khí chế tạo:","questionImage":null,"mappedType":"true-false","statements":[{"statement":"Kĩ sư thiết kế kĩ thuật cơ khí có thể làm việc trong các lĩnh vực như giao thông, robot công nghiệp, chăm sóc sức khỏe. (Nhận biết)","is_correct":true},{"statement":"Người thực hiện nhóm công việc Gia công cơ khí chủ yếu là người thợ cắt gọt kim loại, thợ hàn, thợ rèn dập. (Nhận biết)","is_correct":true},{"statement":"Công việc Lắp ráp sản phẩm cơ khí đòi hỏi người thực hiện phải có kiến thức chuyên sâu về gia công cơ khí (tiện, phay) hơn là kĩ năng đọc bản vẽ. (Thông hiểu)","is_correct":false},{"statement":"Để khắc phục triệt để lỗi vận hành của một chiếc máy đã lâu năm, người thợ bảo dưỡng cần phân tích lịch sử hỏng hóc, so sánh với các quy trình bảo trì trước đó để đưa ra kế hoạch sửa chữa tổng thể. (Vận dụng)","is_correct":true}]},{"type":"true-false","question":null,"main_question":"<a id=\"X336e9c8ddfbd44b00ddc1639d7acd4b47e6c909\"></a> Vai trò của hồ sơ kỹ thuật (2NB, 1TH, 1VDC)<br>Câu dẫn: Nhận định nào dưới đây là ĐÚNG khi nói về vai trò của hồ sơ kĩ thuật trong ngành cơ khí chế tạo?","questionImage":null,"mappedType":"true-false","statements":[{"statement":"Hồ sơ kĩ thuật chỉ bao gồm bản vẽ kĩ thuật (hình học) và không bao gồm quy trình gia công sản phẩm. (Nhận biết)","is_correct":false},{"statement":"Hồ sơ kĩ thuật là sản phẩm đầu ra chính của nhóm công việc Thiết kế sản phẩm cơ khí. (Nhận biết)","is_correct":true},{"statement":"Lắp ráp sản phẩm cơ khí cần có kiến thức chuyên môn vững vàng, nhưng nếu không có hồ sơ kĩ thuật thì vẫn có thể hoàn thành sản phẩm một cách chính xác. (Thông hiểu)","is_correct":false},{"statement":"Việc thay đổi vật liệu chế tạo chi tiết từ thép carbon sang hợp kim nhôm (có độ bền tương đương) đòi hỏi phải quay lại bước thiết kế để tính toán lại tất cả các thông số kĩ thuật (dung sai, độ nhám,...) trên bản vẽ. (Vận dụng cao)","is_correct":true}]},{"type":"true-false","question":null,"main_question":"<a id=\"Xb7a42b131ac15b7aa4d2b3c09b19a6d1a3f8d24\"></a> Các yêu cầu đối với người lao động (2NB, 1TH, 1VD)<br>Câu dẫn: Nhận định nào dưới đây là SAI khi đánh giá về yêu cầu kĩ năng đối với người lao động trong lĩnh vực cơ khí chế tạo?","questionImage":null,"mappedType":"true-false","statements":[{"statement":"Người thợ Gia công cơ khí vận hành máy CNC đòi hỏi phải có sự kiên trì, tỉ mỉ, bình tĩnh. (Nhận biết)","is_correct":true},{"statement":"Người thực hiện công việc Thiết kế sản phẩm cơ khí chỉ cần có kiến thức về Toán học và Vật lí. (Nhận biết)<br>*c. Khả năng làm việc nhóm, sáng tạo và tư duy logic là những kĩ năng cần thiết chung cho tất cả các nhóm ngành nghề cơ khí chế tạo. (Thông hiểu)","is_correct":false},{"statement":"Một kĩ thuật viên có khả năng đọc bản vẽ kém nhưng lại có kĩ năng hàn rất tốt thì vẫn có thể đảm bảo sản phẩm lắp ráp hoàn thiện đạt yêu cầu về độ chính xác kích thước. (Vận dụng)","is_correct":false}]},{"type":"true-false","question":null,"main_question":"<strong></strong> Đánh giá tính đúng.sai của các nhận định sau về các yêu cầu và phân loại của vật liệu cơ khí:","questionImage":null,"mappedType":"true-false","statements":[{"statement":"Vật liệu cơ khí được phân thành 3 nhóm chính: Kim loại và hợp kim, Phi kim loại, và Gốm sứ kĩ thuật.","is_correct":false},{"statement":"Thép carbon, hợp kim nhôm và hợp kim đồng là những ví dụ điển hình của nhóm Vật liệu kim loại và hợp kim.","is_correct":true},{"statement":"Một vật liệu có tính chất hóa học (chống ăn mòn) tốt nhưng tính công nghệ (khả năng hàn) kém có thể làm tăng chi phí chế tạo, làm giảm tính kinh tế tổng thể.","is_correct":true},{"statement":"Để giảm thiểu chi phí và tăng tính kinh tế, kĩ sư nên luôn ưu tiên chọn vật liệu có giá thành thô rẻ nhất cho mọi chi tiết máy.","is_correct":false}]},{"type":"true-false","question":null,"main_question":"<strong></strong> Đánh giá tính đúng.sai của các nhận định sau về vật liệu kim loại và hợp kim phổ biến:","questionImage":null,"mappedType":"true-false","statements":[{"statement":"Gang và Thép là hai loại hợp kim quan trọng nhất thuộc nhóm kim loại đen.","is_correct":true},{"statement":"Thép có hàm lượng carbon lớn hơn Gang, do đó Thép có tính đúc tốt hơn Gang.","is_correct":false},{"statement":"Hợp kim Đồng thau (Đồng-Kẽm) có khả năng chống ăn mòn tốt hơn Đồng thanh (Đồng-Thiếc) trong môi trường nước biển.","is_correct":true},{"statement":"Để giảm thiểu chi phí gia công, ta nên chọn Gang cho chi tiết có hình dạng đơn giản thay vì Thép carbon, vì Gang có tính công nghệ tốt hơn Thép.","is_correct":false}]},{"type":"true-false","question":null,"main_question":"<strong></strong> Đánh giá tính đúng.sai của các nhận định sau về vật liệu phi kim loại phổ biến trong ngành cơ khí:","questionImage":null,"mappedType":"true-false","statements":[{"statement":"Vật liệu phi kim loại có khối lượng riêng lớn hơn so với vật liệu kim loại.","is_correct":false},{"statement":"Nhựa nhiệt dẻo có khả năng cách điện, chống oxi hóa tốt và rất dễ gia công.","is_correct":true},{"statement":"Vật liệu cao su được dùng để chế tạo lốp xe vì nó có tính dẫn điện tốt, giúp loại bỏ tĩnh điện khi xe di chuyển.","is_correct":false},{"statement":"Để chế tạo một chi tiết cần tái chế và sửa chữa nhiều lần, kĩ sư nên ưu tiên chọn vật liệu Nhựa nhiệt rắn vì nó có độ bền cao hơn.","is_correct":false}]},{"type":"true-false","question":null,"main_question":"<strong></strong> Đánh giá tính đúng.sai của các nhận định sau về Vật liệu Composite và Vật liệu Nano:","questionImage":null,"mappedType":"true-false","statements":[{"statement":"Vật liệu nền trong Composite có vai trò chịu tải chính và tăng độ bền cơ học cho vật liệu.","is_correct":false},{"statement":"Vật liệu Nano là vật liệu mà ít nhất một chiều có kích thước dưới 100nm","is_correct":true},{"statement":"Vật liệu Composite nền Polymer (như FRP) thường được ưa chuộng hơn Composite nền Kim loại vì nó có thể chịu nhiệt độ làm việc cao hơn.","is_correct":false},{"statement":"Khi sử dụng Composite sợi Thủy tinh (GFRP) thay thế Thép, kĩ sư phải tính toán thiết kế lại để tăng độ dày chi tiết nhằm bù đắp cho độ cứng kém hơn của GFRP.","is_correct":true}]}];
            const quizOptions = {"timeLimit":100,"retriesAllowed":100,"showAnswers":true,"showExplanation":true,"aiAssessment":true,"scoring":{"mc":7,"tf":3,"sa":0,"essay":0,"tfMethod":"even"}};
            const googleScriptUrl = "https://script.google.com/macros/s/AKfycbwFrgRsOYyp5I4KnPDffimwrwMXH_c5bpxjxqUDnqxqnjoQHV8mUoUZfAwGfWY9CgYf/exec";
            const correctExamCode = "QMI6TJ";
            const teacherApiKey = "AIzaSyDTFy_GnA8GaPaZNP2avwinsBnrDB7hcRw";
            let studentInfo = {};
            let isSubmitted = false;
            let timerInterval;
            let retriesLeft = quizOptions.retriesAllowed;
            let studentApiKey = "";
            let ai = null;

            let proctoringLog = {
                thoatManHinh: 0,
                saoChep: 0,
                dan: 0,
                suKien: []
            };

            const studentQuizContainer = document.getElementById('student-quiz-container');
            const submitBtn = document.getElementById('submit-quiz-btn');
            const resultContainer = document.getElementById('result-container');
            const postSubmitOptions = document.getElementById('post-submit-options');
            const retryBtn = document.getElementById('retry-quiz-btn');
            const loginModal = document.getElementById('login-modal');
            const studentInfoForm = document.getElementById('student-info-form');
            const timerDisplay = document.getElementById('timer-display');
            const retriesDisplay = document.getElementById('retries-display');
            function shuffleQuiz() {
                // Shuffle options/statements within each question first
                quizData.forEach(item => {
                    // Shuffle multiple-choice options and their corresponding images
                    if (item.mappedType === 'multiple-choice' && item.options && item.options.length > 0) {
                        const correctAnswerText = item.options[item.correctAnswerIndex];
                        let optionsWithImages = item.options.map((opt, index) => ({
                            text: opt,
                            image: (item.optionsImage && item.optionsImage[index]) ? item.optionsImage[index] : null
                        }));
                        // Fisher-Yates shuffle
                        for (let i = optionsWithImages.length - 1; i > 0; i--) {
                            const j = Math.floor(Math.random() * (i + 1));
                            [optionsWithImages[i], optionsWithImages[j]] = [optionsWithImages[j], optionsWithImages[i]];
                        }
                        // Update the item with shuffled data
                        item.options = optionsWithImages.map(opt => opt.text);
                        item.optionsImage = optionsWithImages.map(opt => opt.image);
                        item.correctAnswerIndex = item.options.indexOf(correctAnswerText);
                    }
                    // Shuffle true-false statements
                    if (item.mappedType === 'true-false' && item.statements && item.statements.length > 0) {
                         for (let i = item.statements.length - 1; i > 0; i--) {
                            const j = Math.floor(Math.random() * (i + 1));
                            [item.statements[i], item.statements[j]] = [item.statements[j], item.statements[i]];
                        }
                    }
                });
                // Then, group questions by type and shuffle within each group
                const grouped = quizData.reduce((acc, q) => {
                    const type = q.mappedType;
                    if (!acc[type]) {
                        acc[type] = [];
                    }
                    acc[type].push(q);
                    return acc;
                }, {});
                let shuffledQuizData = [];
                const partOrder = ['multiple-choice', 'true-false', 'short-answer', 'essay'];
                partOrder.forEach(partType => {
                    if (grouped[partType]) {
                        const partQuestions = grouped[partType];
                        for (let i = partQuestions.length - 1; i > 0; i--) {
                            const j = Math.floor(Math.random() * (i + 1));
                            [partQuestions[i], partQuestions[j]] = [partQuestions[j], partQuestions[i]];
                        }
                        shuffledQuizData = shuffledQuizData.concat(partQuestions);
                    }
                });
               
                quizData = shuffledQuizData;
            }
            // --- Timer Function ---
            function startTimer(duration, display) {
                let timer = duration, minutes, seconds;
                clearInterval(timerInterval); // Clear any existing timer
                if(duration <= 0) {
                     display.textContent = "∞";
                     return;
                }
                timerInterval = setInterval(function () {
                    minutes = parseInt(timer / 60, 10);
                    seconds = parseInt(timer % 60, 10);
                    minutes = minutes < 10 ? "0" + minutes : minutes;
                    seconds = seconds < 10 ? "0" + seconds : seconds;
                    display.textContent = minutes + ":" + seconds;
                    if (--timer < 0) {
                        clearInterval(timerInterval);
                        alert("Hết giờ làm bài!");
                        handleSubmit();
                    }
                }, 1000);
            }
            
            async function showExplanation(index, button) {
                const item = quizData[index];
                const questionCard = document.getElementById(`student-q-${index}`);
                const feedbackDiv = document.getElementById(`q-${index}-feedback`);
                if (!questionCard || !feedbackDiv) return;

                const existingExplanation = feedbackDiv.querySelector('.ai-explanation');
                if (existingExplanation) {
                    existingExplanation.remove();
                    button.innerHTML = `
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        Xem giải thích
                    `;
                    return;
                }

                button.disabled = true;
                button.innerHTML = '<div class="loader mr-2"></div> Đang tải...';

                if (item.explanation) {
                    displayExplanation(item.explanation, feedbackDiv, button);
                    return;
                }

                if (!ai) {
                    alert("Tính năng giải thích yêu cầu API Key, nhưng chưa được cấu hình bởi giáo viên.");
                    button.disabled = false;
                    button.innerHTML = `
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        Xem giải thích
                    `;
                    return;
                }

                const questionText = item.question || item.main_question;
                let prompt = `Bạn là một trợ lý giáo viên AI, am hiểu sâu sắc Chương trình GDPT 2018. Hãy cung cấp một lời giải chi tiết, từng bước một cho câu hỏi sau đây. Lời giải phải chính xác, dễ hiểu và phù hợp với phương pháp giảng dạy của chương trình học, TUYỆT ĐỐI KHÔNG sử dụng kiến thức của lớp cao hơn để giải thích.\n\n--- CÂU HỎI ---\n${questionText}\n\n`;
                if (item.mappedType === 'multiple-choice') {
                    prompt += `--- CÁC LỰA CHỌN ---\n${item.options.map((opt, i) => `${String.fromCharCode(65 + i)}. ${opt}`).join('\n')}\n\n`;
                    prompt += `--- ĐÁP ÁN ĐÚNG ---\n${String.fromCharCode(65 + item.correctAnswerIndex)}. ${item.options[item.correctAnswerIndex]}`;
                } else if (item.mappedType === 'true-false') {
                    prompt += `--- CÁC MỆNH ĐỀ & ĐÁP ÁN ---\n${item.statements.map(s => ` - ${s.statement} -> ${s.is_correct ? 'Đúng' : 'Sai'}`).join('\n')}`;
                } else {
                    prompt += `--- ĐÁP ÁN / GỢI Ý ---\n${item.answer}`;
                }
                prompt += `\n\n--- YÊU CẦU ---\nGiải thích rõ ràng tại sao đáp án lại đúng, từng bước một. Định dạng tất cả các công thức toán học bằng LaTeX.`;

                try {
                    const response = await ai.models.generateContent({ model: "gemini-2.5-flash", contents: prompt });
                    const explanationText = response.text.replace(/\n/g, '<br>');
                    item.explanation = explanationText; // Cache it
                    displayExplanation(explanationText, feedbackDiv, button);
                } catch (error) {
                    console.error("Lỗi khi tạo giải thích:", error);
                    feedbackDiv.insertAdjacentHTML('beforeend', '<div class="ai-explanation text-red-600">Lỗi: Không thể tạo giải thích.</div>');
                    button.disabled = false;
                    button.innerHTML = `
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        Thử lại
                    `;
                }
            }

            function displayExplanation(explanationText, container, button) {
                container.insertAdjacentHTML('beforeend', `<div class="ai-explanation prose prose-sm">${explanationText}</div>`);
                if (window.MathJax) MathJax.typesetPromise([container]);
                button.disabled = false;
                button.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                    Ẩn giải thích
                `;
            }
           
            function renderStudentQuiz() {
                studentQuizContainer.innerHTML = '';
               
                const grouped = quizData.reduce((acc, q) => {
                    const type = q.mappedType;
                    if (!acc[type]) {
                        acc[type] = [];
                    }
                    acc[type].push(q);
                    return acc;
                }, {});
                const groupInfo = {
                    'multiple-choice': { title: 'PHẦN I. TRẮC NGHIỆM KHÁCH QUAN', subtitle: 'Chọn đáp án đúng nhất trong các lựa chọn sau.' },
                    'true-false': { title: 'PHẦN II. CÂU HỎI ĐÚNG - SAI', subtitle: 'Xác định tính đúng hoặc sai cho mỗi mệnh đề dưới đây.' },
                    'short-answer': { title: 'PHẦN III. CÂU HỎI TRẢ LỜI NGẮN', subtitle: 'Điền đáp án ngắn gọn vào phần trả lời.' },
                    'essay': { title: 'PHẦN IV. CÂU HỎI TỰ LUẬN', subtitle: 'Trình bày chi tiết bài giải của bạn.' }
                };
               
                let questionCounter = 0;
                const partOrder = ['multiple-choice', 'true-false', 'short-answer', 'essay'];
                partOrder.forEach(partType => {
                    const questions = grouped[partType];
                    if (!questions || questions.length === 0) return;
                   
                    let groupHTML = `<div class="group-container space-y-8 mb-12">`;
                    const info = groupInfo[partType];
                    groupHTML += `
                        <div class="group-header pb-3 border-b-2 border-slate-300 mb-6">
                            <h2 class="text-2xl font-bold text-slate-800">${info.title}</h2>
                            ${info.subtitle ? `<p class="text-md text-slate-600 italic mt-1">${info.subtitle}</p>` : ''}
                        </div>
                    `;
                    questions.forEach((item, localIndex) => {
                        const globalIndex = quizData.indexOf(item);
                        questionCounter++;
                        groupHTML += `<div class="question-card" id="student-q-${globalIndex}">`;
                        let questionText = (item.question || item.main_question || '').replace(/\n/g, '<br>');
                       
                        groupHTML += `<div class="flex items-start">
                                     <div class="flex-grow">
                                         <div class="flex items-center mb-2">
                                             <span class="font-bold text-lg mr-3 text-indigo-600">Câu ${questionCounter}:</span>
                                             <div id="q-${globalIndex}-feedback-icon"></div>
                                         </div>
                                         <div class="question-content mt-2 text-lg text-slate-700">${questionText}</div>
                                         ${item.questionImage ? `<img src="${item.questionImage}" class="mt-4 rounded-lg max-w-full md:max-w-md border shadow-sm">` : ''}
                                     </div>
                                 </div>`;
                       
                        groupHTML += `<div class="mt-6">`;
                        switch(item.mappedType) {
                            case 'multiple-choice':
                                groupHTML += `<div class="options-grid grid grid-cols-1 md:grid-cols-2 gap-4">`;
                                item.options.forEach((opt, i) => {
                                    groupHTML += `<label for="q${globalIndex}-opt${i}" id="q${globalIndex}-opt-label${i}" class="option-label flex items-start p-4 border-2 rounded-xl cursor-pointer hover:bg-indigo-50 hover:border-indigo-400">
                                                     <input type="radio" name="q${globalIndex}" id="q${globalIndex}-opt${i}" value="${i}" class="flex-shrink-0 mt-1 h-5 w-5 text-indigo-600 focus:ring-indigo-500 border-gray-300">
                                                     <div class="ml-3 flex-grow">
                                                         <span class="font-semibold text-slate-800">${String.fromCharCode(65 + i)}.</span>
                                                         <span class="option-content text-slate-700">${opt || ''}</span>
                                                         ${(item.optionsImage && item.optionsImage[i]) ? `<img src="${item.optionsImage[i]}" class="mt-2 rounded-lg max-w-xs border shadow-sm">` : ''}
                                                     </div>
                                                 </label>`;
                                });
                                groupHTML += `</div>`;
                                break;
                            case 'true-false':
                                 groupHTML += `<div class="space-y-4">`;
                                 item.statements.forEach((s, i) => {
                                     groupHTML += `<div class="statement-item border-t pt-4">
                                                  <p class="mb-3 text-slate-700">${String.fromCharCode(97 + i)}) ${s.statement || ''}</p>
                                                  <div class="flex gap-x-6">
                                                      <label class="flex items-center cursor-pointer"><input type="radio" name="q${globalIndex}-s${i}" value="true" class="mr-2 h-4 w-4"> Đúng</label>
                                                      <label class="flex items-center cursor-pointer"><input type="radio" name="q${globalIndex}-s${i}" value="false" class="mr-2 h-4 w-4"> Sai</label>
                                                  </div>
                                              </div>`;
                                 });
                                 groupHTML += `</div>`;
                                 break;
                            case 'short-answer':
                                groupHTML += `<input type="text" name="q${globalIndex}" class="mt-1 block w-full md:w-1/2 border border-slate-300 rounded-lg shadow-sm py-2.5 px-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" placeholder="Nhập đáp án của bạn...">`;
                                break;
                            case 'essay':
                                groupHTML += `<textarea name="q${globalIndex}" class="mt-1 block w-full border border-slate-300 rounded-lg shadow-sm py-2.5 px-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" rows="5" placeholder="Nhập câu trả lời tự luận của bạn..."></textarea>`;
                                break;
                        }
                        groupHTML += `</div><div id="q-${globalIndex}-feedback" class="mt-4"></div></div>`;
                    });
                    groupHTML += `</div>`;
                    studentQuizContainer.innerHTML += groupHTML;
                });
               
                if (window.MathJax && typeof window.MathJax.typesetPromise === 'function') {
                    MathJax.typesetPromise([studentQuizContainer]);
                }
            }
           
            async function generatePerformanceReview(allAnswersData) {
                const feedbackContainer = document.getElementById('ai-feedback-container');
                if (!feedbackContainer || !ai) return null;
                feedbackContainer.classList.remove('hidden');
                feedbackContainer.innerHTML = `
                    <div class="bg-white p-6 rounded-xl shadow-lg">
                        <h3 class="text-xl font-bold text-slate-800 mb-4">📝 Phân Tích & Gợi Ý Từ Trợ Lý AI</h3>
                        <div id="ai-feedback-loader" class="text-center py-6">
                            <svg class="animate-spin mx-auto h-10 w-10 text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                            </svg>
                            <p class="mt-3 text-slate-600">AI đang phân tích bài làm của bạn...</p>
                        </div>
                        <div id="ai-feedback-summary" class="hidden prose prose-sm max-w-none"></div>
                        <div id="ai-feedback-details" class="hidden mt-4 space-y-2"></div>
                    </div>
                `;
               
                const loader = document.getElementById('ai-feedback-loader');
                const summaryDiv = document.getElementById('ai-feedback-summary');
                const detailsDiv = document.getElementById('ai-feedback-details');
                const incorrectAnswers = allAnswersData.filter(a => !a.isCorrect);
                if (incorrectAnswers.length === 0) {
                    feedbackContainer.innerHTML = `
                        <div class="bg-white p-6 rounded-xl shadow-lg text-center">
                            <h3 class="text-xl font-bold text-green-600">🎉 Chúc mừng!</h3>
                            <p class="mt-2 text-slate-700">Bạn đã trả lời đúng tất cả các câu hỏi. Làm tốt lắm!</p>
                        </div>
                    `;
                    return { overallFeedback: { summary: "Xuất sắc! Học sinh đã đã trả lời đúng tất cả các câu hỏi." } };
                }
                const summaryPrompt = `Bạn là một trợ lý giáo viên, nói tiếng Việt. Dựa vào tóm tắt các câu trả lời sai của học sinh, hãy đưa ra một nhận xét tổng quan ngắn gọn (khoảng 3-4 câu) về năng lực của học sinh, bao gồm điểm mạnh (suy luận từ các câu làm đúng), điểm yếu (dựa trên các câu sai) và một vài gợi ý ôn tập chung. Lời văn phải khích lệ, rõ ràng.
                Tóm tắt lỗi sai:
                ${JSON.stringify(incorrectAnswers.map(a => ({ cau: a.questionNumber, loai: a.type, cauHoi: a.question.substring(0, 50) + '...' })), null, 2)}`;
                try {
                    const response = await ai.models.generateContent({
                        model: "gemini-2.5-flash",
                        contents: summaryPrompt
                    });
                    summaryDiv.innerHTML = response.text.replace(/\n/g, '<br>');
                    loader.classList.add('hidden');
                    summaryDiv.classList.remove('hidden');
                    detailsDiv.classList.remove('hidden'); 
                } catch (e) {
                    console.error("Lỗi khi lấy nhận xét tổng quan:", e);
                    summaryDiv.innerHTML = '<p class="text-red-600">Lỗi khi tạo nhận xét tổng quan.</p>';
                    loader.classList.add('hidden');
                    summaryDiv.classList.remove('hidden');
                }
               
                const summaryForSheet = summaryDiv.innerText.substring(0, 200) + "...";
                return { overallFeedback: { summary: summaryForSheet } };
            }
            async function handleSubmit() {
                if (isSubmitted) return;
                isSubmitted = true;
                clearInterval(timerInterval);
                
                document.querySelectorAll('input, textarea').forEach(input => input.disabled = true);
                submitBtn.classList.add('hidden');
                postSubmitOptions.classList.remove('hidden');
                if (retriesLeft > 0) {
                    retryBtn.classList.remove('hidden');
                } else {
                    retryBtn.classList.add('hidden');
                }

                const proctoringDataString = JSON.stringify(proctoringLog);

                let totalStudentScore = 0;
                let totalCorrectAnswers = 0;
                let allAnswersData = [];
                const questionCounts = quizData.reduce((acc, q) => {
                    const type = q.mappedType;
                    acc[type] = (acc[type] || 0) + 1;
                    return acc;
                }, {});
                
                quizData.forEach((item, index) => {
                    let questionNumber = index + 1;
                    let answerData = { questionNumber, type: item.type };
                    switch (item.mappedType) {
                        case 'multiple-choice':
                            const selectedOption = document.querySelector(`input[name="q${index}"]:checked`);
                            const isCorrectMC = selectedOption ? parseInt(selectedOption.value) === item.correctAnswerIndex : false;
                            if (isCorrectMC) {
                                totalCorrectAnswers++;
                                if (questionCounts['multiple-choice'] > 0) {
                                   totalStudentScore += quizOptions.scoring.mc / questionCounts['multiple-choice'];
                                }
                            }
                            answerData.question = item.question;
                            answerData.options = item.options;
                            answerData.yourAnswer = selectedOption ? String.fromCharCode(65 + parseInt(selectedOption.value)) : "Không trả lời";
                            answerData.correctAnswer = String.fromCharCode(65 + item.correctAnswerIndex);
                            answerData.isCorrect = isCorrectMC;
                            break;
                        case 'true-false':
                            let correctStatementsCount = 0;
                            let yourAnswerPattern = [];
                            let correctAnswerPattern = [];
                            let details = [];
                            item.statements.forEach((s, i) => {
                                const selectedTF = document.querySelector(`input[name="q${index}-s${i}"]:checked`);
                                const studentChoice = selectedTF ? selectedTF.value === 'true' : null;
                                const isStatementCorrect = studentChoice === s.is_correct;
                               
                                if (isStatementCorrect) correctStatementsCount++;
                               
                                yourAnswerPattern.push(studentChoice === null ? '?' : (studentChoice ? 'Đ' : 'S'));
                                correctAnswerPattern.push(s.is_correct ? 'Đ' : 'S');
                                details.push({ statement: s.statement, yourChoice: studentChoice === null ? 'Không trả lời' : (studentChoice ? 'Đúng' : 'Sai'), correctChoice: s.is_correct ? 'Đúng' : 'Sai', isCorrect: isStatementCorrect });
                            });
                            
                            let scorePerTfQuestion = 0;
                            if (questionCounts['true-false'] > 0) {
                                scorePerTfQuestion = quizOptions.scoring.tf / questionCounts['true-false'];
                            }
                            let questionPoints = 0;
                            if (quizOptions.scoring.tfMethod === 'progressive') {
                                const progressivePoints = { 0: 0, 1: 0.1, 2: 0.25, 3: 0.5, 4: 1.0 };
                                questionPoints = progressivePoints[correctStatementsCount] * scorePerTfQuestion;
                            } else { // even
                                questionPoints = (correctStatementsCount / 4) * scorePerTfQuestion;
                            }
                            totalStudentScore += questionPoints;

                            if(correctStatementsCount === 4) totalCorrectAnswers++;
                            answerData.question = item.main_question;
                            answerData.yourAnswer = yourAnswerPattern.join('-');
                            answerData.correctAnswer = correctAnswerPattern.join('-');
                            answerData.isCorrect = correctStatementsCount === 4;
                            answerData.details = details;
                            break;
                       
                        case 'short-answer':
                            const saInput = document.querySelector(`input[name="q${index}"]`);
                            const studentAnswerRaw = saInput ? (saInput.value ?? '').trim() : "";
                            const correctAnswerRaw = (item.answer ?? '').toString().trim().replace(/\$/g, '');
                            let isCorrectSA = false;
                            const studentAnswerNormalized = studentAnswerRaw.replace(',', '.');
                            const correctAnswerNormalized = correctAnswerRaw.replace(',', '.');
                            if (studentAnswerNormalized.toLowerCase() === correctAnswerNormalized.toLowerCase()) {
                                isCorrectSA = true;
                            }
                             if (isCorrectSA) {
                                totalCorrectAnswers++;
                                if (questionCounts['short-answer'] > 0) {
                                   totalStudentScore += quizOptions.scoring.sa / questionCounts['short-answer'];
                                }
                            }
                            answerData.question = item.question;
                            answerData.yourAnswer = studentAnswerRaw || "Không trả lời";
                            answerData.correctAnswer = correctAnswerRaw;
                            answerData.isCorrect = isCorrectSA;
                            break;
                           
                        case 'essay':
                             const essayInput = document.querySelector(`textarea[name="q${index}"]`);
                             answerData.question = item.question;
                             answerData.yourAnswer = essayInput.value || "Không trả lời";
                             answerData.correctAnswer = item.answer;
                             answerData.isCorrect = null; // Needs manual grading
                             break;
                    }
                    allAnswersData.push(answerData);
                });
                
                const finalScore = totalStudentScore;
                
                let competencyAssessment = "Giáo viên không yêu cầu AI phân tích bài làm.";
                if (quizOptions.aiAssessment) {
                    const feedbackData = await generatePerformanceReview(allAnswersData);
                    if (feedbackData && feedbackData.overallFeedback && feedbackData.overallFeedback.summary) {
                        competencyAssessment = feedbackData.overallFeedback.summary;
                    } else {
                        competencyAssessment = "Có lỗi xảy ra trong quá trình AI phân tích bài làm.";
                    }
                }
                
                if (quizOptions.showAnswers) {
                    const totalQuestions = quizData.length;
                    resultContainer.innerHTML = `<div class="bg-white p-6 rounded-xl shadow-lg text-center">
                        <h3 class="text-2xl font-bold text-slate-800">KẾT QUẢ BÀI LÀM</h3>
                        <p class="mt-4 text-lg">Số câu đúng hoàn toàn: <span class="font-bold text-green-600">${totalCorrectAnswers}/${totalQuestions}</span></p>
                        <p class="text-2xl mt-2">Điểm (thang 10): <span class="font-bold text-blue-600">${finalScore.toFixed(2)}</span></p>
                        ${questionCounts['essay'] > 0 ? `<p class="text-sm text-gray-600 italic mt-1">Lưu ý: Điểm trên chưa bao gồm ${quizOptions.scoring.essay} điểm của phần Tự luận.</p>` : ''}
                    </div>`;
                    resultContainer.classList.remove('hidden');

                    allAnswersData.forEach((ans, index) => {
                        const questionCard = document.getElementById(`student-q-${index}`);
                        const feedbackIconDiv = document.getElementById(`q-${index}-feedback-icon`);
                        const feedbackDiv = document.getElementById(`q-${index}-feedback`);
                        if (!questionCard || !feedbackIconDiv || !feedbackDiv) return;

                        const iconHTML = ans.isCorrect === true
                            ? '<svg class="feedback-icon text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>'
                            : (ans.isCorrect === false ? '<svg class="feedback-icon text-red-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg>' : '');
                        feedbackIconDiv.innerHTML = iconHTML;

                        if (ans.type.includes('multiple-choice')) {
                            const studentChoice = ans.yourAnswer === "Không trả lời" ? -1 : ans.yourAnswer.charCodeAt(0) - 65;
                            const correctChoice = ans.correctAnswer.charCodeAt(0) - 65;
                            document.getElementById(`q-${index}-opt-label${correctChoice}`)?.classList.add('correct');
                            if (studentChoice !== -1 && studentChoice !== correctChoice) {
                                document.getElementById(`q-${index}-opt-label${studentChoice}`)?.classList.add('incorrect');
                            }
                        } else if (ans.type === 'true-false') {
                            const statementItems = questionCard.querySelectorAll('.statement-item');
                            ans.details.forEach((detail, i) => { if(statementItems[i]) { statementItems[i].classList.add(detail.isCorrect ? 'correct' : 'incorrect'); }});
                        }

                        if (quizOptions.showExplanation) {
                            feedbackDiv.innerHTML = `<button data-explain-index="${index}" class="explain-btn mt-4 flex items-center px-4 py-2 bg-blue-100 text-blue-800 text-sm font-semibold rounded-lg hover:bg-blue-200 transition-colors">
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                Xem giải thích
                            </button>`;
                        }
                    });
                    
                    document.querySelectorAll('.explain-btn').forEach(btn => {
                        btn.addEventListener('click', (e) => {
                            const button = e.currentTarget;
                            const index = parseInt(button.dataset.explainIndex, 10);
                            showExplanation(index, button);
                        });
                    });

                    if (window.MathJax) await window.MathJax.typesetPromise([studentQuizContainer]);
                } else {
                     resultContainer.innerHTML = `<div class="bg-white p-6 rounded-xl shadow-lg text-center"><h3 class="text-xl font-bold text-green-600">Nộp bài thành công!</h3><p class="mt-2 text-slate-700">Bạn đã hoàn thành bài làm. Kết quả sẽ được giáo viên công bố sau.</p></div>`;
                    resultContainer.classList.remove('hidden');
                }
                
                const formData = new FormData();
                formData.append('name', studentInfo.name);
                formData.append('class', studentInfo.class);
                formData.append('score', `${finalScore.toFixed(2)}/10`);
                formData.append('assessment', competencyAssessment);
                formData.append('timestamp', new Date().toLocaleString('vi-VN'));
                formData.append('examCode', correctExamCode);
                formData.append('monitoringLog', proctoringDataString);
                formData.append('answerDetails', JSON.stringify(allAnswersData));
               
                fetch(googleScriptUrl, { method: 'POST', body: formData})
                    .then(res => console.log("Successfully submitted to Google Sheet"))
                    .catch(err => console.error("Error submitting to Google Sheet:", err));
            }
           
            function startNewAttempt() {
                isSubmitted = false;
                proctoringLog = { thoatManHinh: 0, saoChep: 0, dan: 0, suKien: [] };
                const proctoringWidget = document.getElementById('proctoring-widget');
                if (proctoringWidget) {
                    proctoringWidget.classList.add('hidden');
                    document.getElementById('tab-switch-count').textContent = '0';
                    document.getElementById('copy-count').textContent = '0';
                    document.getElementById('paste-count').textContent = '0';
                }

                renderStudentQuiz();
                resultContainer.classList.add('hidden');
                document.getElementById('ai-feedback-container').classList.add('hidden');
                postSubmitOptions.classList.add('hidden');
                submitBtn.classList.remove('hidden');
                 if (quizOptions.timeLimit > 0) {
                    const timeInSeconds = quizOptions.timeLimit * 60;
                    startTimer(timeInSeconds, timerDisplay);
                }
                retriesLeft--;
                retriesDisplay.textContent = `Lượt làm lại còn: ${retriesLeft}`;
                window.scrollTo(0, 0);
            }
            studentInfoForm.addEventListener('submit', (e) => {
                e.preventDefault();
               
                const enteredCode = document.getElementById('exam-code').value.trim().toUpperCase();
                if (correctExamCode && enteredCode !== correctExamCode) {
                    alert('Mã đề không chính xác. Vui lòng kiểm tra lại!');
                    return;
                }
               
                studentApiKey = teacherApiKey;
                if (!studentApiKey) {
                    console.warn('Cảnh báo: Giáo viên chưa cấu hình API Key. Các tính năng AI sẽ không hoạt động.');
                }
       
                try {
                    if (studentApiKey) {
                       ai = new GoogleGenAI({ apiKey: studentApiKey });
                    }
                } catch(e) {
                    console.error("Lỗi khởi tạo Gemini API với key của giáo viên.", e);
                    alert("Cảnh báo: API Key của giáo viên không hợp lệ. Vui lòng báo cho giáo viên. Các tính năng AI sẽ không hoạt động.");
                    ai = null;
                }
                shuffleQuiz();
               
                studentInfo.name = document.getElementById('student-name').value;
                studentInfo.class = document.getElementById('student-class').value;
                loginModal.classList.add('hidden');
                studentQuizContainer.classList.remove('hidden');
                submitBtn.classList.remove('hidden');
               
                if (quizOptions.timeLimit > 0) {
                    const timeInSeconds = quizOptions.timeLimit * 60;
                    startTimer(timeInSeconds, timerDisplay);
                } else {
                    timerDisplay.textContent = "Không giới hạn";
                }
                retriesDisplay.textContent = `Lượt làm lại còn: ${retriesLeft}`;
                renderStudentQuiz();

                const proctoringWidget = document.getElementById('proctoring-widget');
                const tabSwitchCountEl = document.getElementById('tab-switch-count');
                const copyCountEl = document.getElementById('copy-count');
                const pasteCountEl = document.getElementById('paste-count');

                function updateProctoringUI() {
                    if (proctoringLog.thoatManHinh > 0 || proctoringLog.saoChep > 0 || proctoringLog.dan > 0) {
                        proctoringWidget.classList.remove('hidden');
                    }
                    tabSwitchCountEl.textContent = proctoringLog.thoatManHinh;
                    copyCountEl.textContent = proctoringLog.saoChep;
                    pasteCountEl.textContent = proctoringLog.dan;
                }

                // Disable Right Click
                document.addEventListener('contextmenu', e => e.preventDefault());

                // Track Tab Switching
                document.addEventListener('visibilitychange', () => {
                    if (document.hidden && !isSubmitted) {
                        proctoringLog.thoatManHinh++;
                        proctoringLog.suKien.push({ loai: 'chuyen_tab', thoiGian: new Date().toISOString() });
                        updateProctoringUI();
                    }
                });

                // Track Copying
                document.addEventListener('copy', () => {
                    if (isSubmitted) return;
                    proctoringLog.saoChep++;
                    proctoringLog.suKien.push({ loai: 'sao_chep', thoiGian: new Date().toISOString() });
                    updateProctoringUI();
                });

                // Track Pasting
                document.addEventListener('paste', () => {
                    if (isSubmitted) return;
                    proctoringLog.dan++;
                    proctoringLog.suKien.push({ loai: 'dan', thoiGian: new Date().toISOString() });
                    updateProctoringUI();
                });
            });
            
            submitBtn.addEventListener('click', handleSubmit);
            retryBtn.addEventListener('click', () => {
                shuffleQuiz();
                startNewAttempt();
            });
        </script>
    </body>
    </html>
    