
    <!DOCTYPE html>
    <html lang="vi">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>ĐỀ CƯƠNG ÔN TẬP THI GIỮA KỲ 1</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700&display=swap" rel="stylesheet">
        <script>
            window.MathJax = {
                tex: {
                    packages: {'[+]': ['ams']},
                    inlineMath: [['$', '$'], ['\\(', '\\)']],
                    displayMath: [['$$', '$$'], ['\\[', '\\]']]
                },
                chtml: {
                    fontCache: 'global',
                    linebreaks: {
                        automatic: true
                    }
                }
            };
        </script>
        <script type="text/javascript" id="MathJax-script" async
            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
        </script>
        <style>
            body { font-family: 'Be Vietnam Pro', sans-serif; background-color: #f0f4f8; }
            .loader { border: 4px solid #f3f3f3; border-top: 4px solid #3b82f6; border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; }
            @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
            .question-card {
                background-color: white;
                border-radius: 1rem;
                padding: 1.5rem 2rem;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
                border-left: 5px solid transparent;
                transition: all 0.3s ease;
            }
            .ai-explanation {
                background-color: #f0f9ff;
                color: #0c4a6e;
                padding: 1rem;
                border-radius: 0.75rem;
                font-size: 0.9rem;
                margin-top: 1rem;
                border-left: 4px solid #38bdf8;
            }
            .feedback-icon { width: 1.5rem; height: 1.5rem; }
            .option-label {
                transition: all 0.2s ease-in-out;
                border: 2px solid #e5e7eb;
            }
            .option-label:hover {
                border-color: #6366f1;
                background-color: #eef2ff;
            }
            .option-label.correct {
                border-color: #10b981 !important;
                background-color: #ecfdf5 !important;
                color: #065f46;
            }
            .option-label.incorrect {
                border-color: #ef4444 !important;
                background-color: #fef2f2 !important;
                color: #991b1b;
            }
            .statement-item.correct { background-color: #ecfdf5; border-color: #10b981; }
            .statement-item.incorrect { background-color: #fef2f2; border-color: #ef4444; }
            .prose { max-width: 100%; }
            .prose h1, .prose h2, .prose h3 { font-weight: 600; }
            .prose p { margin-top: 0.5em; margin-bottom: 0.5em; }
            .prose ul, .prose ol { margin-top: 1em; margin-bottom: 1em; padding-left: 1.5em; }
            .prose li > p { margin-top: 0; margin-bottom: 0; }
            .prose code { background-color: #e5e7eb; padding: 0.2em 0.4em; margin: 0; font-size: 85%; border-radius: 3px; }
            .prose pre { background-color: #e5e7eb; padding: 1em; border-radius: 0.5em; overflow-x: auto; }
            .prose pre code { background-color: transparent; padding: 0; }
            details[open] > summary .details-arrow {
                transform: rotate(180deg);
            }
        </style>
    </head>
    <body class="bg-slate-100 text-slate-800">
        <div id="login-modal" class="fixed inset-0 bg-gray-900 bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4">
            <div class="bg-white p-8 rounded-2xl shadow-2xl w-full max-w-md transform transition-all" style="animation: fadeIn 0.3s ease-out;">
                <h2 class="text-2xl font-bold mb-2 text-center text-slate-800">Thông Tin Học Sinh</h2>
                <p class="text-center text-slate-500 mb-6">Vui lòng nhập để bắt đầu làm bài.</p>
                <form id="student-info-form">
                    <div class="mb-4">
                        <label for="student-name" class="block text-sm font-medium text-slate-700 mb-1">Họ và tên</label>
                        <input type="text" id="student-name" required class="mt-1 block w-full block border border-slate-300 rounded-lg shadow-sm py-2.5 px-3 focus:border-indigo-500 focus:ring-indigo-500">
                    </div>
                    <div class="mb-4">
                        <label for="student-class" class="block text-sm font-medium text-slate-700 mb-1">Lớp</label>
                        <input type="text" id="student-class" required class="mt-1 block w-full border border-slate-300 rounded-lg shadow-sm py-2.5 px-3 focus:border-indigo-500 focus:ring-indigo-500">
                    </div>
                    <div class="mb-4">
                        <label for="exam-code" class="block text-sm font-medium text-slate-700 mb-1">Mã đề</label>
                        <input type="text" id="exam-code" required class="mt-1 block w-full border border-slate-300 rounded-lg shadow-sm py-2.5 px-3 focus:border-indigo-500 focus:ring-indigo-500" placeholder="Nhập mã đề giáo viên cung cấp">
                    </div>
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-slate-700 mb-1">Giáo viên:</label>
                        <p class="mt-1 text-slate-800 bg-slate-100 p-2.5 rounded-lg">LÊ VĂN ĐÔNG</p>
                    </div>
                    <button type="submit" class="w-full bg-indigo-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-transform transform hover:scale-105">Bắt đầu làm bài</button>
                </form>
            </div>
        </div>
        <div class="container mx-auto p-4 md:p-8 max-w-4xl">
            <header class="mb-10 p-8 rounded-xl bg-gradient-to-r from-blue-500 to-indigo-600 text-white shadow-lg">
                <div class="flex justify-between items-center flex-wrap gap-4">
                    <div>
                        <h1 class="text-4xl font-bold">ĐỀ CƯƠNG ÔN TẬP THI GIỮA KỲ 1</h1>
                        <p class="text-lg text-blue-100 mt-2">Hãy hoàn thành các câu hỏi dưới đây một cách tốt nhất!</p>
                        <p class="text-sm text-blue-200 mt-4">Tác giả: LÊ VĂN ĐÔNG</p>
                    </div>
                    <div id="timer-container" class="text-right">
                         <div id="timer-display" class="text-3xl font-bold tracking-wider bg-white/20 px-4 py-2 rounded-lg">--:--</div>
                         <div id="retries-display" class="text-sm mt-1 text-blue-200"></div>
                    </div>
                </div>
            </header>
            <main id="student-quiz-container" class="space-y-8 hidden">
                <!-- Questions will be rendered here by JS -->
            </main>
            <footer class="mt-10 text-center">
                <button id="submit-quiz-btn" class="bg-indigo-600 text-white py-3 px-12 rounded-full font-bold text-lg hover:bg-indigo-700 transition-all duration-300 shadow-lg hover:shadow-xl hidden transform hover:scale-105">Nộp Bài</button>
                <div id="result-container" class="mt-6 hidden"></div>
                <div id="ai-feedback-container" class="mt-8 text-left hidden"></div>
                <div id="post-submit-options" class="hidden mt-6 flex flex-col sm:flex-row items-center justify-center gap-4">
                    <button id="retry-quiz-btn" class="w-full sm:w-auto bg-slate-600 text-white py-2.5 px-6 rounded-lg font-semibold hover:bg-slate-700 transition-transform transform hover:scale-105">Làm Lại Đề Này</button>
                </div>
            </footer>
        </div>

        <div id="proctoring-widget" class="fixed bottom-4 right-4 bg-yellow-100 text-yellow-800 p-3 rounded-lg shadow-lg text-sm z-50 hidden border border-yellow-300" style="max-width: 200px;">
            <h4 class="font-bold mb-2 border-b border-yellow-300 pb-1 flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 3.001-1.742 3.001H4.42c-1.53 0-2.493-1.667-1.743-3.001l5.58-9.92zM10 13a1 1 0 110-2 1 1 0 010 2zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" /></svg>
                Giám sát
            </h4>
            <p>Thoát màn hình: <span id="tab-switch-count" class="font-bold">0</span></p>
            <p>Sao chép: <span id="copy-count" class="font-bold">0</span></p>
            <p>Dán: <span id="paste-count" class="font-bold">0</span></p>
        </div>

        <script type="module">
            import { GoogleGenAI, Type } from "https://esm.sh/@google/genai@^1.13.0";
            let quizData = [{"type":"multiple-choice","question":"<strong></strong> Hệ thống nhận dạng khuôn mặt trong điện thoại minh họa cho đặc trưng nào của AI?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Khả năng học tập","Khả năng nhận thức","Khả năng giao tiếp","Khả năng suy luận"],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> Đặc trưng “khả năng suy luận” của AI được thể hiện rõ nhất trong ví dụ nào dưới đây?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Hệ thống chẩn đoán bệnh dựa trên triệu chứng người dùng nhập vào","Xe tự lái nhận diện vật cản","Chatbot trả lời câu hỏi","Ứng dụng dịch văn bản tự động"],"optionsImage":[null,null,null,null],"correctAnswerIndex":0},{"type":"multiple-choice","question":"<strong></strong> Trợ lý ảo (như Siri, Google Assistant) giao tiếp được với con người bằng tiếng nói là minh chứng cho đặc trưng nào của AI?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Khả năng học tập","Khả năng hiểu ngôn ngữ tự nhiên","Khả năng nhận thức","Khả năng suy luận"],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> Hệ thống robot có thể tự động vận hành dây chuyền sản xuất mà không cần con người điều khiển trực tiếp thể hiện đặc trưng nào của AI?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Khả năng giao tiếp","Khả năng tự động hóa","Khả năng nhận thức","Khả năng học tập"],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> Trong các đặc trưng sau, đâu là yếu tố giúp AI có thể thích nghi và cải thiện hiệu suất theo thời gian?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Khả năng học tập","Khả năng nhận thức","Khả năng giao tiếp","Khả năng tự động hóa"],"optionsImage":[null,null,null,null],"correctAnswerIndex":0},{"type":"multiple-choice","question":"<strong></strong> Ứng dụng AI nào thể hiện đồng thời khả năng học tập và giao tiếp với con người?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Xe tự lái","Chatbot chăm sóc khách hàng","Hệ thống phát hiện gian lận giao dịch","Phần mềm xếp thời khóa biểu"],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> Đặc trưng “khả năng nhận thức” trong AI được hiểu là:","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["AI biết ghi nhớ dữ liệu trong thời gian dài","AI cảm nhận và hiểu biết về môi trường xung quanh thông qua cảm biến","AI có thể trò chuyện tự nhiên với con người","AI rút ra quy luật từ dữ liệu"],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> Lợi ích nổi bật nhất của AI trong đời sống là:","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Giúp con người nghỉ ngơi hoàn toàn, không cần làm việc","Tăng hiệu quả công việc và hỗ trợ con người trong nhiều lĩnh vực","Thay thế hoàn toàn con người trong mọi ngành nghề","Làm giảm năng suất lao động"],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> Ứng dụng của AI trong sản xuất mang lại lợi ích nào sau đây?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Làm giảm năng suất và hiệu quả lao động","Giúp tối ưu hóa quy trình và phát hiện lỗi sản phẩm","Làm cho công việc thủ công phức tạp hơn","Tăng chi phí vận hành"],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> Trong y tế, AI giúp ích cho con người bằng cách:","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Chẩn đoán bệnh nhanh và chính xác hơn","Tự động sản xuất thuốc thay con người","Làm tăng tỷ lệ sai sót trong khám bệnh","Thay thế hoàn toàn bác sĩ"],"optionsImage":[null,null,null,null],"correctAnswerIndex":0},{"type":"multiple-choice","question":"<strong></strong> AI giúp con người giảm tải công việc lặp đi lặp lại nhờ:","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Tự động hóa các quy trình và thao tác thường xuyên","Yêu cầu con người nhập dữ liệu liên tục","Làm chậm tiến độ làm việc","Giảm tính chính xác trong xử lý thông tin"],"optionsImage":[null,null,null,null],"correctAnswerIndex":0},{"type":"multiple-choice","question":"<strong></strong> Một trong những lợi ích quan trọng của AI trong đời sống hàng ngày là:","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Gây khó khăn trong giao tiếp giữa người và máy","Hỗ trợ con người tìm kiếm và xử lý thông tin nhanh chóng","Làm tăng khối lượng công việc","Làm giảm chất lượng dịch vụ"],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> Trong nông nghiệp, AI được ứng dụng để:","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Tăng lượng phân bón sử dụng","Dự đoán thời tiết và tối ưu quy trình canh tác","Giảm năng suất thu hoạch","Thay thế hoàn toàn người nông dân"],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> AI mang lại lợi ích gì trong việc hỗ trợ con người học tập và làm việc?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Cản trở việc sáng tạo","Giúp học tập và làm việc thông minh, hiệu quả hơn","Giới hạn khả năng tự học","Làm con người phụ thuộc hoàn toàn vào máy"],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> Vì sao cần sử dụng AI một cách có trách nhiệm?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Để AI có thể tự quyết định mọi việc thay con người","Để hạn chế các tác động tiêu cực và bảo đảm AI phục vụ lợi ích chung của xã hội","Để AI hoạt động tự do không bị kiểm soát","Vì AI luôn đúng nên không cần kiểm tra kết quả"],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> Hành vi nào sau đây thể hiện việc sử dụng AI thiếu trách nhiệm?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Dùng AI để viết báo cáo học tập tham khảo và ghi rõ nguồn","Dùng AI để lan truyền thông tin sai sự thật","Dùng AI để học ngoại ngữ nhanh hơn","Dùng AI để hỗ trợ sáng tạo nội dung học tập"],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> Trong các hành động sau, đâu là ví dụ ứng xử nhân văn khi sử dụng AI?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Dùng AI để chế giễu người khác trên mạng","Dùng AI để sao chép nội dung hỗ trợ học tập cho bạn bè","Dùng AI để sao chép nội dung người khác mà không ghi nguồn","Dùng AI để vượt qua bài kiểm tra mà không học"],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> Sử dụng AI một cách an toàn nghĩa là gì?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Dùng AI ở bất kỳ nền tảng nào không cần xem xét","Giữ bí mật thông tin cá nhân và không chia sẻ dữ liệu nhạy cảm cho AI","Cho phép AI truy cập toàn bộ dữ liệu riêng tư","Dùng AI thay cho mọi hình thức học tập"],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> Thiết bị nào sau đây có chức năng kết nối nhiều máy tính trong cùng mạng nội bộ (LAN) để chúng có thể trao đổi dữ liệu với nhau?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Modem","Router","Switch","Access Point"],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"<strong></strong> Thiết bị mạng nào có chức năng phát sóng Wi-Fi để các thiết bị không dây kết nối vào mạng nội bộ?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Router","Wireless Access Point (WAP)","Switch","Hub"],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> Khi xem hình ảnh một thiết bị mạng có nhiều cổng LAN (RJ45) và đèn LED nhấp nháy cho từng cổng, đó thường là thiết bị nào?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Hub hoặc Switch","Router","Modem","Access Point"],"optionsImage":[null,null,null,null],"correctAnswerIndex":0},{"type":"multiple-choice","question":"<strong></strong> Thiết bị nào thường kết hợp nhiều chức năng như Modem, Router và Access Point trong cùng một thiết bị (được sử dụng phổ biến trong gia đình)?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Switch","Hub","Router Wi-Fi","Modem quang đơn thuần"],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"<strong></strong> Điểm khác biệt cơ bản giữa Modem và Router là gì?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Modem phát sóng Wi-Fi, còn Router không thể","Router chỉ dùng cho mạng có dây, Modem dùng cho mạng không dây","Modem kết nối Internet, Router chia sẻ kết nối Internet cho các thiết bị khác","Modem lưu trữ dữ liệu, Router xử lý dữ liệu"],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"<strong></strong> So với Hub, Switch có ưu điểm gì?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Switch gửi dữ liệu đến đúng máy đích, trong khi Hub gửi đến tất cả máy trong mạng","Switch rẻ hơn và tốc độ thấp hơn Hub","Hub có thể lọc dữ liệu thông minh hơn Switch","Hub và Switch hoạt động hoàn toàn giống nhau"],"optionsImage":[null,null,null,null],"correctAnswerIndex":0},{"type":"multiple-choice","question":"<strong></strong> Trong mạng LAN, nếu muốn giảm xung đột dữ liệu và tăng hiệu quả truyền thông tin, nên sử dụng thiết bị nào?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Hub","Switch","Modem","Access Point"],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> Lợi ích chính của việc chia sẻ tài nguyên trong mạng là gì?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Giúp tăng tốc độ xử lý của máy tính trong mạng.","Cho phép người dùng cùng sử dụng dữ liệu hoặc thiết bị chung.","Làm giảm dung lượng bộ nhớ trên các máy tính cá nhân.","Giúp hệ điều hành cập nhật phần mềm nhanh hơn."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> Để chia sẻ một thư mục trong hệ điều hành Windows, thao tác đúng là:","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Mở thư mục rồi chọn lệnh Share this file.","Nháy chuột phải, chọn Properties → Sharing → Advanced Sharing.","Sao chép thư mục ra ổ đĩa ngoài rồi chọn Send to Network.","Mở trình duyệt và đăng nhập vào tài khoản Microsoft."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> Trong hộp thoại Advanced Sharing, để bật chế độ chia sẻ thư mục, cần chọn:","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Share this folder.","Allow file sharing.","Enable sharing mode.","Turn on folder sharing."],"optionsImage":[null,null,null,null],"correctAnswerIndex":0},{"type":"multiple-choice","question":"<strong></strong> Tùy chọn Permissions trong cửa sổ chia sẻ dùng để làm gì?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Chọn người dùng và thiết lập quyền truy cập thư mục.","Tạo bản sao lưu dữ liệu trước khi chia sẻ.","Đặt mật khẩu bảo vệ cho thư mục được chia sẻ.","Kiểm tra tốc độ truyền dữ liệu trong mạng."],"optionsImage":[null,null,null,null],"correctAnswerIndex":0},{"type":"multiple-choice","question":"<strong></strong> Quyền Full Control trong chia sẻ thư mục cho phép người dùng:","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Chỉ xem nội dung của các tệp trong thư mục.","Sửa đổi, xóa và thay đổi quyền chia sẻ thư mục.","Chỉ tạo thêm tệp và thư mục con mới.","Chỉ sao chép dữ liệu sang thiết bị khác."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> Người dùng được cấp quyền Change có thể:","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Đọc, ghi và xóa các tệp trong thư mục chia sẻ.","Thay đổi quyền truy cập cho người khác.","Sao chép thư mục ra máy chủ khác.","Thay đổi cài đặt mạng của máy tính."],"optionsImage":[null,null,null,null],"correctAnswerIndex":0},{"type":"multiple-choice","question":"<strong></strong> Quyền Read cho phép người dùng thực hiện thao tác nào dưới đây?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Chỉ xem và sao chép nội dung thư mục chia sẻ.","Sửa và lưu lại các tệp trong thư mục chia sẻ.","Xóa hoặc đổi tên các tệp trong thư mục chia sẻ.","Chia sẻ lại thư mục đó cho người dùng khác."],"optionsImage":[null,null,null,null],"correctAnswerIndex":0},{"type":"multiple-choice","question":"<strong></strong> Khi người dùng có quyền Change, họ không được phép:","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Đọc nội dung tệp tin trong thư mục chia sẻ.","Thêm, sửa hoặc xóa các tệp tin có sẵn.","Thay đổi quyền hạn chia sẻ của thư mục.","Ghi thêm tệp tin mới vào thư mục đó."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"<strong></strong> Việc phân quyền khi chia sẻ thư mục có ý nghĩa gì?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Giúp tăng tốc độ chia sẻ giữa các máy tính trong mạng.","Giúp đảm bảo an toàn và bảo mật cho dữ liệu được chia sẻ.","Giúp mở rộng dung lượng lưu trữ của hệ thống mạng.","Giúp hệ điều hành tự động cập nhật các tệp chia sẻ."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> Đặc điểm nổi bật của giao tiếp trong không gian mạng là:","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Diễn ra chủ yếu bằng lời nói trực tiếp giữa người với người.","Chỉ có thể thực hiện khi hai người cùng ở một vị trí địa lý.","Không bị giới hạn về không gian, thời gian và có tính ẩn danh cao.","Đòi hỏi người tham gia phải có trình độ kỹ thuật chuyên sâu."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"<strong></strong> Giao tiếp trong không gian mạng khác với giao tiếp trực tiếp ở điểm nào sau đây?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Có thể sử dụng biểu cảm, hình ảnh, ký hiệu để thể hiện cảm xúc.","Thường diễn ra chậm và khó lưu lại thông tin hơn.","Không có yếu tố phi ngôn ngữ và luôn mang tính chính xác tuyệt đối.","Không cho phép người dùng phản hồi hay tương tác."],"optionsImage":[null,null,null,null],"correctAnswerIndex":2},{"type":"multiple-choice","question":"<strong></strong> Ưu điểm nổi bật của giao tiếp trong không gian mạng là:","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Giúp con người tránh hoàn toàn rủi ro khi chia sẻ thông tin.","Cho phép kết nối và trao đổi thông tin nhanh chóng, thuận tiện.","Bắt buộc người dùng phải xác minh danh tính thật khi tham gia.","Đảm bảo mọi thông tin đều chính xác và đáng tin cậy."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> Nhược điểm của giao tiếp trong không gian mạng là:","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Dễ gây ra hiểu lầm, tin giả hoặc các hành vi thiếu kiểm soát.","Không thể trao đổi tệp tin hay hình ảnh qua mạng Internet.","Yêu cầu người dùng phải trả phí cho mọi hình thức giao tiếp.","Không lưu lại lịch sử hội thoại giữa các bên tham gia."],"optionsImage":[null,null,null,null],"correctAnswerIndex":0},{"type":"multiple-choice","question":"<strong></strong> Một rủi ro có thể gặp khi giao tiếp trong không gian mạng là:","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Thông tin cá nhân bị thu thập hoặc sử dụng sai mục đích.","Không thể chia sẻ dữ liệu hay hình ảnh cá nhân cho người khác.","Tốc độ truyền tin luôn chậm hơn so với giao tiếp truyền thống.","Giao tiếp bị gián đoạn do thiếu người trung gian xác nhận."],"optionsImage":[null,null,null,null],"correctAnswerIndex":0},{"type":"multiple-choice","question":"<strong></strong> Hành vi nào dưới đây là ứng xử phù hợp trong giao tiếp trên mạng?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Dùng từ ngữ lịch sự, tôn trọng người khác khi bình luận.","Đăng tải thông tin cá nhân của người khác mà không xin phép.","Phản hồi bình luận tiêu cực bằng lời lẽ gay gắt và xúc phạm.","Lan truyền nội dung chưa được kiểm chứng để “cảnh báo cộng đồng”."],"optionsImage":[null,null,null,null],"correctAnswerIndex":0},{"type":"multiple-choice","question":"<strong></strong> Hành vi nào được xem là không phù hợp trong giao tiếp trực tuyến?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Tôn trọng quyền riêng tư của người khác.","Chia sẻ các tin tức sai lệch hoặc bình luận tiêu cực.","Sử dụng ngôn ngữ rõ ràng, thân thiện khi trao đổi.","Thể hiện thái độ lắng nghe và phản hồi có trách nhiệm."],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> Khi tham gia giao tiếp trong không gian mạng, người dùng cần thực hiện việc gì?","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Kiểm tra tính xác thực của thông tin trước khi chia sẻ.","Chia sẻ mọi thông tin cá nhân để tạo sự tin cậy.","Dùng biệt danh để tránh chịu trách nhiệm về nội dung.","Thường xuyên bình luận để thể hiện quan điểm cá nhân."],"optionsImage":[null,null,null,null],"correctAnswerIndex":0},{"type":"multiple-choice","question":"<strong></strong> IP là viết tắt của Internet Protocol.","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Đúng","Sai","Không xác định","Tùy trường hợp"],"optionsImage":[null,null,null,null],"correctAnswerIndex":0},{"type":"multiple-choice","question":"<strong></strong> IP quy định cách gói dữ liệu được định địa chỉ và dẫn đường trong mạng.","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Đúng","Sai","Không xác định","Tùy trường hợp"],"optionsImage":[null,null,null,null],"correctAnswerIndex":0},{"type":"multiple-choice","question":"<strong></strong> Khi máy tính không được cấp địa chỉ IP, nó không thể truy cập Internet.","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Đúng","Sai","Không xác định","Tùy trường hợp"],"optionsImage":[null,null,null,null],"correctAnswerIndex":0},{"type":"multiple-choice","question":"<strong></strong> TCP là viết tắt của Transmission Control Protocol.","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Đúng","Sai","Không xác định","Tùy trường hợp"],"optionsImage":[null,null,null,null],"correctAnswerIndex":0},{"type":"multiple-choice","question":"<strong></strong> TCP đảm bảo dữ liệu được gửi đi nhanh nhất có thể, không cần kiểm tra lỗi.","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Đúng","Sai","Không xác định","Tùy trường hợp"],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> TCP có cơ chế kiểm soát lỗi và sắp xếp lại gói tin theo đúng thứ tự khi đến nơi.","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Đúng","Sai","Không xác định","Tùy trường hợp"],"optionsImage":[null,null,null,null],"correctAnswerIndex":0},{"type":"multiple-choice","question":"<strong></strong> TCP sử dụng IP để định tuyến các gói dữ liệu đến đúng nơi nhận.","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Đúng","Sai","Không xác định","Tùy trường hợp"],"optionsImage":[null,null,null,null],"correctAnswerIndex":0},{"type":"multiple-choice","question":"<strong></strong> Khi một gói tin bị mất trên đường truyền, TCP sẽ yêu cầu IP gửi lại gói đó.","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Đúng","Sai","Không xác định","Tùy trường hợp"],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> IPv6 vẫn dùng dấu chấm (.) để phân tách các phần trong địa chỉ IP.","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Đúng","Sai","Không xác định","Tùy trường hợp"],"optionsImage":[null,null,null,null],"correctAnswerIndex":1},{"type":"multiple-choice","question":"<strong></strong> IPv6 được tạo ra để khắc phục tình trạng thiếu địa chỉ của IPv4.","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Đúng","Sai","Không xác định","Tùy trường hợp"],"optionsImage":[null,null,null,null],"correctAnswerIndex":0},{"type":"multiple-choice","question":"<strong></strong> Khi cấu hình mạng trong doanh nghiệp lớn, nên ưu tiên IPv6 để có nhiều địa chỉ và bảo mật cao hơn.","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Đúng","Sai","Không xác định","Tùy trường hợp"],"optionsImage":[null,null,null,null],"correctAnswerIndex":0},{"type":"multiple-choice","question":"<strong></strong> Việc đánh giá, bình luận một cách khách quan, tôn trọng sự khác biệt của người khác là biểu hiện của ứng xử phù hợp trong môi trường mạng.","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Đúng","Sai","Không xác định","Tùy trường hợp"],"optionsImage":[null,null,null,null],"correctAnswerIndex":0},{"type":"multiple-choice","question":"<strong></strong> Khi gửi tệp tin qua Internet, việc chọn giao thức phù hợp (như HTTP, FTP) ảnh hưởng đến tốc độ và độ tin cậy truyền dữ liệu.","main_question":null,"questionImage":null,"mappedType":"multiple-choice","options":["Đúng","Sai","Không xác định","Tùy trường hợp"],"optionsImage":[null,null,null,null],"correctAnswerIndex":0},{"type":"true-false","question":null,"main_question":"<strong></strong> Đọc các phát biểu sau và cho biết chúng là Đúng hay Sai về vai trò và thách thức của Trí tuệ nhân tạo trong khoa học và đời sống.","questionImage":null,"mappedType":"true-false","statements":[{"statement":"AI cần được phát triển dựa trên các chuẩn mực đạo đức và tri thức khoa học của con người.","is_correct":true},{"statement":"Hệ thống AI vẫn hoạt động đúng dù được huấn luyện với dữ liệu không chính xác.","is_correct":false},{"statement":"Khi sử dụng chatbot AI, người dùng cần có thái độ tôn trọng và kiểm soát nội dung phản hồi để đảm bảo tính nhân văn.","is_correct":true},{"statement":"AI có thể bị lợi dụng để thực hiện hành vi lừa đảo qua mạng như giả giọng nói hoặc khuôn mặt.","is_correct":true}]},{"type":"true-false","question":null,"main_question":"<strong></strong> Đọc các phát biểu sau và cho biết chúng là Đúng hay Sai về ảnh hưởng của Trí tuệ nhân tạo đến an ninh mạng và hành vi người dùng.","questionImage":null,"mappedType":"true-false","statements":[{"statement":"AI hoàn toàn không liên quan đến các rủi ro về an ninh mạng.","is_correct":false},{"statement":"Việc AI có thể mô phỏng hành động của con người khiến các hành vi tấn công mạng tinh vi hơn.","is_correct":true},{"statement":"Người sử dụng AI cần nâng cao nhận thức bảo mật, xác minh nguồn tin và cẩn trọng khi giao dịch trực tuyến.","is_correct":true},{"statement":"AI có thể thu thập và xử lý dữ liệu cá nhân của người dùng để đưa ra gợi ý phù trị.","is_correct":true}]},{"type":"true-false","question":null,"main_question":"<strong></strong> Đọc các phát biểu sau và cho biết chúng là Đúng hay Sai về quyền riêng tư và tác động xã hội của Trí tuệ nhân tạo.","questionImage":null,"mappedType":"true-false","statements":[{"statement":"Quyền riêng tư của người dùng hoàn toàn được bảo vệ trong mọi hệ thống AI.","is_correct":false},{"statement":"Nếu AI bị lạm dụng, thông tin cá nhân có thể bị sử dụng sai mục đích hoặc trái pháp luật.","is_correct":true},{"statement":"Người dùng nên đọc kỹ chính sách bảo mật và hạn chế chia sẻ dữ liệu cá nhân khi sử dụng ứng dụng AI.","is_correct":true},{"statement":"AI không ảnh hưởng gì đến cơ cấu lao động trong tương lai.","is_correct":false}]},{"type":"true-false","question":null,"main_question":"<strong></strong> Đọc các phát biểu sau và cho biết chúng là Đúng hay Sai về tác động của Trí tuệ nhân tạo đến lao động và xã hội.","questionImage":null,"mappedType":"true-false","statements":[{"statement":"Việc ứng dụng AI giúp tăng năng suất lao động nhưng cũng làm thay đổi nhu cầu về kỹ năng của người lao động.","is_correct":true},{"statement":"AI có tiềm năng giải quyết nhiều vấn đề phức tạp trong y học và môi trường.","is_correct":true},{"statement":"Phát triển AI chỉ cần tập trung vào hiệu suất mà không cần quan tâm đến tính minh bạch.","is_correct":false},{"statement":"Dữ liệu lớn là yếu tố cần thiết để huấn luyện các mô hình AI hiệu quả.","is_correct":true}]},{"type":"true-false","question":null,"main_question":"<strong></strong> Hãy xác định các phát biểu sau là Đúng (Đ) hay Sai (S) về sự thích ứng của con người với sự phát triển của công nghệ và Trí tuệ nhân tạo:","questionImage":null,"mappedType":"true-false","statements":[{"statement":"Để thích ứng, con người cần học tập suốt đời và phát triển kỹ năng sáng tạo, giao tiếp, tư duy phản biện.","is_correct":true},{"statement":"AI mang lại cả lợi ích và thách thức cho xã hội hiện đại.","is_correct":true},{"statement":"AI chỉ gây ra rủi ro, không có đóng góp tích cực nào cho con người.","is_correct":false},{"statement":"Nếu không kiểm soát tốt, AI có thể gây ra các vấn đề về đạo đức, quyền riêng tư và việc làm.","is_correct":true}]},{"type":"true-false","question":null,"main_question":"<strong></strong> Hãy xác định các phát biểu sau là Đúng (Đ) hay Sai (S) về nhận dạng và vai trò các thiết bị mạng (Hub, Switch, WAP, Router, Modem):","questionImage":null,"mappedType":"true-false","statements":[{"statement":"Switch dùng để kết nối các máy tính trong cùng mạng LAN, giúp trao đổi dữ liệu giữa các thiết bị.","is_correct":true},{"statement":"Modem có chức năng phát sóng Wi-Fi cho thiết bị di động kết nối Internet.","is_correct":false},{"statement":"Router vừa có thể định tuyến dữ liệu giữa các mạng khác nhau, vừa có khả năng phát sóng Wi-Fi cho thiết bị không dây.","is_correct":true},{"statement":"Trong sơ đồ mạng gia đình, Router thường được đặt giữa Modem và các thiết bị đầu cuối (máy tính, điện thoại).","is_correct":true}]},{"type":"true-false","question":null,"main_question":"<strong></strong> Hãy xác định các phát biểu sau là Đúng (Đ) hay Sai (S) về sự phân biệt Hub và Switch trong mạng nội bộ:","questionImage":null,"mappedType":"true-false","statements":[{"statement":"Hub gửi dữ liệu đến tất cả các máy trong mạng, dù máy đó có phải đích đến hay không.","is_correct":true},{"statement":"Switch chỉ gửi dữ liệu đến đúng máy đích, giúp giảm xung đột dữ liệu trong mạng LAN.","is_correct":true},{"statement":"Switch và Hub hoạt động giống nhau, chỉ khác về hình dạng bên ngoài.","is_correct":false},{"statement":"Khi thiết kế mạng văn phòng nhỏ, nên chọn Switch thay vì Hub để tăng tốc độ và hiệu quả truyền dữ liệu.","is_correct":true}]},{"type":"true-false","question":null,"main_question":"<strong></strong> Hãy xác định các phát biểu sau là Đúng (Đ) hay Sai (S) về phân biệt Router và Modem, và vai trò của chúng trong sơ đồ mạng:","questionImage":null,"mappedType":"true-false","statements":[{"statement":"Modem có chức năng chuyển đổi tín hiệu giữa mạng Internet của nhà cung cấp dịch vụ (ISP) và mạng nội bộ (LAN).","is_correct":true},{"statement":"Router có thể định tuyến và chia sẻ kết nối Internet cho nhiều thiết bị khác nhau trong mạng.","is_correct":true},{"statement":"Router và Modem là hai thiết bị hoàn toàn giống nhau, vì cả hai đều dùng để kết nối Internet.","is_correct":false},{"statement":"Trong sơ đồ mạng, nếu muốn mở rộng phạm vi phủ sóng Wi-Fi, có thể thêm một Access Point sau Router.","is_correct":true}]},{"type":"true-false","question":null,"main_question":"<strong></strong> Hãy xác định các phát biểu sau là Đúng (Đ) hay Sai (S) về Giao thức mạng:","questionImage":null,"mappedType":"true-false","statements":[{"statement":"Giao thức mạng là tập hợp các quy tắc quy định cách các thiết bị trong mạng giao tiếp với nhau.","is_correct":true},{"statement":"Mọi mạng máy tính đều chỉ có một giao thức duy nhất để truyền dữ liệu.","is_correct":false},{"statement":"Giao thức mạng giúp đảm bảo dữ liệu được truyền đúng nơi, đúng cách và có thể hiểu được giữa các thiết bị khác nhau.","is_correct":true},{"statement":"Khi gửi tệp tin qua Internet, việc chọn giao thức phù hợp (như HTTP, FTP) ảnh hưởng đến tốc độ độ và độ tin cậy truyền dữ liệu.","is_correct":true}]},{"type":"true-false","question":null,"main_question":"<strong></strong> Hãy xác định các phát biểu sau là Đúng (D) hay Sai (S) về giao tiếp và ứng xử trong không gian mạng.","questionImage":null,"mappedType":"true-false","statements":[{"statement":"Không gian mạng là môi trường vật lý để con người giao tiếp trực tiếp với nhau.","is_correct":false},{"statement":"Một đặc điểm của giao tiếp trong không gian mạng là tính ẩn danh cao và dễ lan truyền thông tin.","is_correct":true},{"statement":"Trong giao tiếp mạng, mọi thông tin đều chính xác và đáng tin cậy hơn so với giao tiếp trực tiếp.","is_correct":false},{"statement":"Ưu điểm của giao tiếp trong không gian mạng là giúp kết nối nhanh chóng, tiết kiệm thời gian và chi phí.","is_correct":true}]},{"type":"true-false","question":null,"main_question":"<strong></strong> Hãy xác định các phát biểu sau là Đúng (D) hay Sai (S) về hành vi ứng xử trong không gian mạng.","questionImage":null,"mappedType":"true-false","statements":[{"statement":"Việc chia sẻ thông tin cá nhân một cách công khai trên mạng là hành vi ứng xử phù hợp trong giao tiếp trực tuyến.","is_correct":false},{"statement":"Sử dụng ngôn ngữ lịch sự, tôn trọng người khác khi bình luận trên mạng là hành vi ứng xử phù hợp.","is_correct":true},{"statement":"Lan truyền tin giả hoặc thông tin chưa kiểm chứng là hành vi ứng xử không phù hợp trong giao tiếp mạng.","is_correct":true},{"statement":"Ứng xử nhân văn trong không gian mạng là biết tôn trọng, cảm thông và chia sẻ tích cực với người khác khi tương tác trực tuyến.","is_correct":true}]},{"type":"true-false","question":null,"main_question":"<strong></strong> Hãy xác định các phát biểu sau là Đúng (D) hay Sai (S) về ứng xử nhân văn trên mạng.","questionImage":null,"mappedType":"true-false","statements":[{"statement":"Người có ứng xử nhân văn trên mạng thường bình luận theo cảm xúc cá nhân, không cần quan tâm đến cảm nhận của người khác.","is_correct":false},{"statement":"Khi thấy một bình luận tiêu cực trên mạng, lựa chọn im lặng hoặc báo cáo vi phạm thay vì đáp trả gay gắt là cách ứng xử phù hợp.","is_correct":true},{"statement":"Khi tham gia thảo luận nhóm trực tuyến, việc lắng nghe ý kiến của người khác và phản hồi có văn hóa thể hiện kỹ năng ứng xử mạng tốt.","is_correct":true},{"statement":"Đăng tải thông tin xúc phạm người khác để “phản công” lại là cách ứng xử mạnh mẽ và đúng đắn trong không gian mạng.","is_correct":false}]},{"type":"essay","question":"<strong></strong> Em hãy đề xuất 3 cách sử dụng trí tuệ nhân tạo an toàn, đúng mục đích và có trách nhiệm với xã hội?<br><em>Đáp án/Gợi ý:</em><br>Để sử dụng trí tuệ nhân tạo an toàn, đúng mục đích và có trách nhiệm với xã hội, có thể đề xuất các cách sau: 1. Tuân thủ đạo đức AI: Đảm bảo AI được phát triển và sử dụng theo các nguyên tắc đạo đức, minh bạch, công bằng, không phân biệt đối xử và tôn trọng quyền riêng tư cá nhân. 2. Kiểm soát và giám sát chặt chẽ: Thiết lập các cơ chế kiểm soát, giám sát hoạt động của AI để kịp thời phát hiện và ngăn chặn các hành vi lạm dụng hoặc gây hại. 3. Giáo dục và nâng cao nhận thức: Tăng cường giáo dục cộng đồng về tiềm năng và rủi ro của AI, giúp người dùng hiểu rõ cách sử dụng AI một cách có trách nhiệm và phát triển kỹ năng tư duy phản biện.","main_question":null,"questionImage":null,"mappedType":"essay","answer":null},{"type":"essay","question":"<strong></strong> Em hãy nêu hai mặt tích cực và hai mặt tiêu cực của việc sử dụng trí tuệ nhân tạo (AI) trong đời sống hằng ngày?<br><em>Đáp án/Gợi ý:</em><br>Hai mặt tích cực của việc sử dụng AI: 1. Nâng cao hiệu suất và tự động hóa: AI giúp tự động hóa các công việc lặp đi lặp lại, tăng năng suất lao động trong nhiều ngành như sản xuất, dịch vụ, y tế. 2. Cải thiện chất lượng cuộc sống: AI hỗ trợ trong y tế (chẩn đoán bệnh, phát triển thuốc), giao thông (xe tự lái, tối ưu hóa lộ trình), giáo dục (hệ thống học tập cá nhân hóa). Hai mặt tiêu cực của việc sử dụng AI: 1. Rủi ro về quyền riêng tư và bảo mật: AI thu thập và xử lý lượng lớn dữ liệu, có thể dẫn đến vi phạm quyền riêng tư và rủi ro bảo mật nếu không được quản lý chặt chẽ. 2. Mất việc làm và thay đổi cơ cấu xã hội: Một số công việc truyền thống có thể bị thay thế bởi AI, gây ra thách thức về việc làm và yêu cầu người lao động phải thích nghi với các kỹ năng mới.","main_question":null,"questionImage":null,"mappedType":"essay","answer":null},{"type":"essay","question":"<strong></strong> Hãy trình bày mối quan hệ giữa hai giao thức TCP và IP trong việc truyền dữ liệu qua mạng Internet?<br><em>Đáp án/Gợi ý:</em><br>TCP (Transmission Control Protocol) và IP (Internet Protocol) là hai giao thức cốt lõi trong bộ giao thức TCP/IP, hoạt động phối hợp để đảm bảo dữ liệu được truyền tải hiệu quả và đáng tin cậy qua Internet. IP chịu trách nhiệm định tuyến các gói dữ liệu từ nguồn đến đích thông qua các địa chỉ IP, nhưng không đảm bảo việc các gói đến đúng thứ tự hay có mất mát hay không. TCP hoạt động ở tầng cao hơn, có nhiệm vụ phân chia dữ liệu thành các gói nhỏ hơn, đánh số thứ tự, gửi lại các gói bị mất, và sắp xếp lại chúng tại đích, đảm bảo dữ liệu được nhận đầy đủ và đúng thứ tự. Nói cách khác, IP là 'hệ thống đường bộ' đưa các gói dữ liệu đến đúng địa chỉ, còn TCP là 'người quản lý vận chuyển' đảm bảo hàng hóa (dữ liệu) đến nơi an toàn, nguyên vẹn và đúng thứ tự.","main_question":null,"questionImage":null,"mappedType":"essay","answer":null},{"type":"essay","question":"<strong></strong> Giả sử khi truyền dữ liệu trên Internet, chỉ có giao thức IP hoạt động mà không có TCP hỗ trợ. Theo em, điều gì có thể xảy ra với dữ liệu được gửi đi?<br><em>Đáp án/Gợi ý:</em><br>Nếu chỉ có giao thức IP hoạt động mà không có TCP hỗ trợ, dữ liệu được gửi đi sẽ gặp các vấn đề nghiêm trọng: 1. Dữ liệu có thể bị mất mát: IP không đảm bảo gửi lại các gói dữ liệu bị mất trên đường truyền. 2. Dữ liệu có thể đến không đúng thứ tự: IP không có cơ chế đánh số và sắp xếp lại các gói, khiến dữ liệu tại đích có thể lộn xộn, không thể ghép lại thành thông tin ban đầu. 3. Không có cơ chế kiểm soát lỗi hay tắc nghẽn: IP không phát hiện và xử lý các lỗi truyền dẫn hay điều chỉnh tốc độ gửi khi mạng bị tắc nghẽn, dẫn đến hiệu suất thấp và dễ bị đứt kết nối. Do đó, việc truyền tải dữ liệu đáng tin cậy như gửi email, tải tệp, hoặc duyệt web sẽ gần như không thể thực hiện được.","main_question":null,"questionImage":null,"mappedType":"essay","answer":null},{"type":"essay","question":"<strong></strong> Nêu ví dụ minh họa cho thấy vai trò phối hợp giữa TCP và IP khi người dùng gửi một tệp trên Internet?<br><em>Đáp án/Gợi ý:</em><br>Khi người dùng gửi một tệp lớn qua Internet (ví dụ: tải lên Google Drive), vai trò phối hợp giữa TCP và IP diễn ra như sau: 1. **Phân chia dữ liệu (TCP):** Tệp lớn được ứng dụng (thông qua TCP) chia thành hàng nghìn gói dữ liệu nhỏ. Mỗi gói được gán một số thứ tự và các thông tin cần thiết để kiểm tra lỗi. 2. **Định tuyến gói (IP):** Mỗi gói dữ liệu sau khi được TCP chuẩn bị sẽ được IP gán địa chỉ IP đích và địa chỉ IP nguồn. IP sau đó sẽ tìm đường tốt nhất để gửi từng gói qua các router trên Internet đến máy chủ Google Drive. 3. **Đảm bảo truyền tải (TCP):** Khi các gói dữ liệu đến máy chủ, TCP trên máy chủ sẽ nhận các gói, kiểm tra số thứ tự, phát hiện gói nào bị mất hoặc hỏng (nếu có) và yêu cầu máy gửi gửi lại. TCP cũng sẽ sắp xếp lại các gói theo đúng thứ tự ban đầu. 4. **Ghép lại tệp:** Khi tất cả các gói đã được nhận đầy đủ và đúng thứ tự, TCP sẽ ghép chúng lại thành tệp ban đầu, hoàn tất quá trình truyền tải. Nếu không có TCP, các gói dữ liệu có thể đến lộn xộn, mất mát và tệp sẽ không thể được ghép lại chính xác.","main_question":null,"questionImage":null,"mappedType":"essay","answer":null},{"type":"essay","question":"<strong></strong> Hãy trình bày các bước chia sẻ một thư mục cho các máy khác trong mạng nội bộ bằng hệ điều hành Windows?<br><em>Đáp án/Gợi ý:</em><br>Các bước chia sẻ một thư mục cho các máy khác trong mạng nội bộ bằng hệ điều hành Windows: 1. **Chuột phải vào thư mục muốn chia sẻ**, chọn 'Properties' (Thuộc tính). 2. Chuyển sang tab 'Sharing' (Chia sẻ) và nhấn vào nút 'Advanced Sharing...' (Chia sẻ nâng cao...). 3. Trong cửa sổ 'Advanced Sharing', **đánh dấu chọn vào ô 'Share this folder'** (Chia sẻ thư mục này). 4. Nhấn vào nút 'Permissions' (Quyền). Tại đây, thêm người dùng hoặc nhóm 'Everyone' (Mọi người) và **cấp quyền đọc (Read) hoặc đọc/ghi (Full Control)** tùy theo nhu cầu. Nhấn 'OK' hai lần để thoát. 5. Quay lại cửa sổ 'Properties', chọn tab 'Security' (Bảo mật). **Đảm bảo nhóm 'Everyone' hoặc người dùng/nhóm được chia sẻ có quyền truy cập phù hợp** (ít nhất là đọc) để tránh bị từ chối truy cập. 6. **Tắt chế độ chia sẻ có mật khẩu** trong 'Network and Sharing Center' (Trung tâm mạng và chia sẻ) nếu muốn truy cập không cần mật khẩu (Control Panel &gt; Network and Internet &gt; Network and Sharing Center &gt; Change advanced sharing settings &gt; All Networks &gt; Turn off password protected sharing).","main_question":null,"questionImage":null,"mappedType":"essay","answer":null},{"type":"essay","question":"<strong></strong> Khi chia sẻ thư mục qua mạng LAN, người dùng thông báo: 'Máy tính khác không truy cập được thư mục chia sẻ dù đã bật Sharing.' Hãy nêu ít nhất hai nguyên nhân có thể xảy ra và cách khắc phục tương ứng?<br><em>Đáp án/Gợi ý:</em><br>Hai nguyên nhân phổ biến và cách khắc phục khi máy tính khác không truy cập được thư mục chia sẻ dù đã bật Sharing: 1. **Nguyên nhân:** Quyền bảo mật (NTFS Permissions) chưa được cấp đủ cho người dùng/nhóm. Mặc dù đã bật chia sẻ, nhưng nếu quyền bảo mật trên thư mục (tab Security trong Properties) không cho phép người dùng từ máy khác truy cập, họ sẽ bị từ chối. **Cách khắc phục:** Truy cập lại 'Properties' của thư mục, vào tab 'Security', thêm nhóm 'Everyone' (hoặc người dùng/nhóm cụ thể) và cấp quyền đọc hoặc 'Full Control' theo mong muốn. 2. **Nguyên nhân:** Tường lửa của Windows hoặc phần mềm diệt virus chặn kết nối. Tường lửa có thể mặc định chặn các kết nối đến từ mạng khác, ngăn không cho truy cập vào thư mục chia sẻ. **Cách khắc phục:** Tạm thời tắt tường lửa hoặc phần mềm diệt virus để kiểm tra. Nếu là do tường lửa, cần tạo một quy tắc ngoại lệ (exception rule) cho phép 'File and Printer Sharing' (Chia sẻ tệp và máy in) qua tường lửa cho mạng nội bộ.","main_question":null,"questionImage":null,"mappedType":"essay","answer":null}];
            const quizOptions = {"timeLimit":45,"retriesAllowed":3,"showAnswers":true,"showExplanation":true,"aiAssessment":true,"scoring":{"mc":4,"tf":3,"sa":0,"essay":3,"tfMethod":"progressive"}};
            const googleScriptUrl = "https://script.google.com/macros/s/AKfycbzAhhPPCUgw-uU55gOj87Tm16ugz8FuBlRwQ7sECOBiOWBC8n6SI2mt_mQblXdoCdje/exec";
            const correctExamCode = "KR97L0";
            const teacherApiKey = "AIzaSyDzpJyodrQYlL0_OmSq4k3snugEgphM6IE";
            let studentInfo = {};
            let isSubmitted = false;
            let timerInterval;
            let retriesLeft = quizOptions.retriesAllowed;
            let studentApiKey = "";
            let ai = null;

            let proctoringLog = {
                thoatManHinh: 0,
                saoChep: 0,
                dan: 0,
                suKien: []
            };

            const studentQuizContainer = document.getElementById('student-quiz-container');
            const submitBtn = document.getElementById('submit-quiz-btn');
            const resultContainer = document.getElementById('result-container');
            const postSubmitOptions = document.getElementById('post-submit-options');
            const retryBtn = document.getElementById('retry-quiz-btn');
            const loginModal = document.getElementById('login-modal');
            const studentInfoForm = document.getElementById('student-info-form');
            const timerDisplay = document.getElementById('timer-display');
            const retriesDisplay = document.getElementById('retries-display');

            function formatAIText(text) {
                if (!text) return '';
                let formattedText = text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                formattedText = formattedText.replace(/\n/g, '<br>');
                return formattedText;
            }

            function shuffleQuiz() {
                // Shuffle options/statements within each question first
                quizData.forEach(item => {
                    // Shuffle multiple-choice options and their corresponding images
                    if (item.mappedType === 'multiple-choice' && item.options && item.options.length > 0) {
                        const correctAnswerText = item.options[item.correctAnswerIndex];
                        let optionsWithImages = item.options.map((opt, index) => ({
                            text: opt,
                            image: (item.optionsImage && item.optionsImage[index]) ? item.optionsImage[index] : null
                        }));
                        // Fisher-Yates shuffle
                        for (let i = optionsWithImages.length - 1; i > 0; i--) {
                            const j = Math.floor(Math.random() * (i + 1));
                            [optionsWithImages[i], optionsWithImages[j]] = [optionsWithImages[j], optionsWithImages[i]];
                        }
                        // Update the item with shuffled data
                        item.options = optionsWithImages.map(opt => opt.text);
                        item.optionsImage = optionsWithImages.map(opt => opt.image);
                        item.correctAnswerIndex = item.options.indexOf(correctAnswerText);
                    }
                    // Shuffle true-false statements
                    if (item.mappedType === 'true-false' && item.statements && item.statements.length > 0) {
                         for (let i = item.statements.length - 1; i > 0; i--) {
                            const j = Math.floor(Math.random() * (i + 1));
                            [item.statements[i], item.statements[j]] = [item.statements[j], item.statements[i]];
                        }
                    }
                });
                // Then, group questions by type and shuffle within each group
                const grouped = quizData.reduce((acc, q) => {
                    const type = q.mappedType;
                    if (!acc[type]) {
                        acc[type] = [];
                    }
                    acc[type].push(q);
                    return acc;
                }, {});
                let shuffledQuizData = [];
                const partOrder = ['multiple-choice', 'true-false', 'short-answer', 'essay'];
                partOrder.forEach(partType => {
                    if (grouped[partType]) {
                        const partQuestions = grouped[partType];
                        for (let i = partQuestions.length - 1; i > 0; i--) {
                            const j = Math.floor(Math.random() * (i + 1));
                            [partQuestions[i], partQuestions[j]] = [partQuestions[j], partQuestions[i]];
                        }
                        shuffledQuizData = shuffledQuizData.concat(partQuestions);
                    }
                });
               
                quizData = shuffledQuizData;
            }
            // --- Timer Function ---
            function startTimer(duration, display) {
                let timer = duration, minutes, seconds;
                clearInterval(timerInterval); // Clear any existing timer
                if(duration <= 0) {
                     display.textContent = "∞";
                     return;
                }
                timerInterval = setInterval(function () {
                    minutes = parseInt(timer / 60, 10);
                    seconds = parseInt(timer % 60, 10);
                    minutes = minutes < 10 ? "0" + minutes : minutes;
                    seconds = seconds < 10 ? "0" + seconds : seconds;
                    display.textContent = minutes + ":" + seconds;
                    if (--timer < 0) {
                        clearInterval(timerInterval);
                        alert("Hết giờ làm bài!");
                        handleSubmit();
                    }
                }, 1000);
            }
            
            async function showExplanation(index, button) {
                const item = quizData[index];
                const questionCard = document.getElementById(`student-q-${index}`);
                const feedbackDiv = document.getElementById(`q-${index}-feedback`);
                if (!questionCard || !feedbackDiv) return;

                const existingExplanation = feedbackDiv.querySelector('.ai-explanation');
                if (existingExplanation) {
                    existingExplanation.remove();
                    button.innerHTML = `
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        Xem giải thích
                    `;
                    return;
                }

                button.disabled = true;
                button.innerHTML = '<div class="loader mr-2"></div> Đang tải...';

                if (item.explanation) {
                    displayExplanation(item.explanation, feedbackDiv, button);
                    return;
                }

                if (!ai) {
                    alert("Tính năng giải thích yêu cầu API Key, nhưng chưa được cấu hình bởi giáo viên.");
                    button.disabled = false;
                    button.innerHTML = `
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        Xem giải thích
                    `;
                    return;
                }

                const questionText = item.question || item.main_question;
                let prompt = `Bạn là một trợ lý giáo viên AI, am hiểu sâu sắc Chương trình GDPT 2018. Hãy cung cấp một lời giải chi tiết, từng bước một cho câu hỏi sau đây. Lời giải phải chính xác, dễ hiểu và phù hợp với phương pháp giảng dạy của chương trình học, TUYỆT ĐỐI KHÔNG sử dụng kiến thức của lớp cao hơn để giải thích.\n\n--- CÂU HỎI ---\n${questionText}\n\n`;
                if (item.mappedType === 'multiple-choice') {
                    prompt += `--- CÁC LỰA CHỌN ---\n${item.options.map((opt, i) => `${String.fromCharCode(65 + i)}. ${opt}`).join('\n')}\n\n`;
                    prompt += `--- ĐÁP ÁN ĐÚNG ---\n${String.fromCharCode(65 + item.correctAnswerIndex)}. ${item.options[item.correctAnswerIndex]}`;
                } else if (item.mappedType === 'true-false') {
                    prompt += `--- CÁC MỆNH ĐỀ & ĐÁP ÁN ---\n${item.statements.map(s => ` - ${s.statement} -> ${s.is_correct ? 'Đúng' : 'Sai'}`).join('\n')}`;
                } else {
                    prompt += `--- ĐÁP ÁN / GỢI Ý ---\n${item.answer}`;
                }
                prompt += `\n\n--- YÊU CẦU ---\nGiải thích rõ ràng tại sao đáp án lại đúng, từng bước một. Dùng **...** để in đậm các thuật ngữ quan trọng. Định dạng tất cả các công thức toán học bằng LaTeX.`;

                try {
                    const response = await ai.models.generateContent({ model: "gemini-2.5-flash", contents: prompt });
                    const explanationText = response.text; // Keep it raw
                    item.explanation = explanationText; // Cache it
                    displayExplanation(explanationText, feedbackDiv, button);
                } catch (error) {
                    console.error("Lỗi khi tạo giải thích:", error);
                    feedbackDiv.insertAdjacentHTML('beforeend', '<div class="ai-explanation text-red-600">Lỗi: Không thể tạo giải thích.</div>');
                    button.disabled = false;
                    button.innerHTML = `
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        Thử lại
                    `;
                }
            }

            function displayExplanation(explanationText, container, button) {
                container.insertAdjacentHTML('beforeend', `<div class="ai-explanation prose prose-sm">${formatAIText(explanationText)}</div>`);
                if (window.MathJax) MathJax.typesetPromise([container]);
                button.disabled = false;
                button.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                    Ẩn giải thích
                `;
            }
           
            function renderStudentQuiz() {
                studentQuizContainer.innerHTML = '';
               
                const grouped = quizData.reduce((acc, q) => {
                    const type = q.mappedType;
                    if (!acc[type]) {
                        acc[type] = [];
                    }
                    acc[type].push(q);
                    return acc;
                }, {});
                const groupInfo = {
                    'multiple-choice': { title: 'PHẦN I. TRẮC NGHIỆM KHÁCH QUAN', subtitle: 'Chọn đáp án đúng nhất trong các lựa chọn sau.' },
                    'true-false': { title: 'PHẦN II. CÂU HỎI ĐÚNG - SAI', subtitle: 'Xác định tính đúng hoặc sai cho mỗi mệnh đề dưới đây.' },
                    'short-answer': { title: 'PHẦN III. CÂU HỎI TRẢ LỜI NGẮN', subtitle: 'Điền đáp án ngắn gọn vào phần trả lời.' },
                    'essay': { title: 'PHẦN IV. CÂU HỎI TỰ LUẬN', subtitle: 'Trình bày chi tiết bài giải của bạn.' }
                };
               
                let questionCounter = 0;
                const partOrder = ['multiple-choice', 'true-false', 'short-answer', 'essay'];
                partOrder.forEach(partType => {
                    const questions = grouped[partType];
                    if (!questions || questions.length === 0) return;
                   
                    let groupHTML = `<div class="group-container space-y-8 mb-12">`;
                    const info = groupInfo[partType];
                    groupHTML += `
                        <div class="group-header pb-3 border-b-2 border-slate-300 mb-6">
                            <h2 class="text-2xl font-bold text-slate-800">${info.title}</h2>
                            ${info.subtitle ? `<p class="text-md text-slate-600 italic mt-1">${info.subtitle}</p>` : ''}
                        </div>
                    `;
                    questions.forEach((item, localIndex) => {
                        const globalIndex = quizData.indexOf(item);
                        questionCounter++;
                        groupHTML += `<div class="question-card" id="student-q-${globalIndex}">`;
                        let questionText = (item.question || item.main_question || '').replace(/\n/g, '<br>');
                       
                        groupHTML += `<div class="flex items-start">
                                     <div class="flex-grow">
                                         <div class="flex items-center mb-2">
                                             <span class="font-bold text-lg mr-3 text-indigo-600">Câu ${questionCounter}:</span>
                                             <div id="q-${globalIndex}-feedback-icon"></div>
                                         </div>
                                         <div class="question-content mt-2 text-lg text-slate-700">${questionText}</div>
                                         ${item.questionImage ? `<img src="${item.questionImage}" class="mt-4 rounded-lg max-w-full md:max-w-md border shadow-sm">` : ''}
                                     </div>
                                 </div>`;
                       
                        groupHTML += `<div class="mt-6">`;
                        switch(item.mappedType) {
                            case 'multiple-choice':
                                groupHTML += `<div class="options-grid grid grid-cols-1 md:grid-cols-2 gap-4">`;
                                item.options.forEach((opt, i) => {
                                    groupHTML += `<label for="q${globalIndex}-opt${i}" id="q${globalIndex}-opt-label${i}" class="option-label flex items-start p-4 border-2 rounded-xl cursor-pointer hover:bg-indigo-50 hover:border-indigo-400">
                                                     <input type="radio" name="q${globalIndex}" id="q${globalIndex}-opt${i}" value="${i}" class="flex-shrink-0 mt-1 h-5 w-5 text-indigo-600 focus:ring-indigo-500 border-gray-300">
                                                     <div class="ml-3 flex-grow">
                                                         <span class="font-semibold text-slate-800">${String.fromCharCode(65 + i)}.</span>
                                                         <span class="option-content text-slate-700">${opt || ''}</span>
                                                         ${(item.optionsImage && item.optionsImage[i]) ? `<img src="${item.optionsImage[i]}" class="mt-2 rounded-lg max-w-xs border shadow-sm">` : ''}
                                                     </div>
                                                 </label>`;
                                });
                                groupHTML += `</div>`;
                                break;
                            case 'true-false':
                                 groupHTML += `<div class="space-y-4">`;
                                 item.statements.forEach((s, i) => {
                                     groupHTML += `<div class="statement-item border-t pt-4">
                                                  <p class="mb-3 text-slate-700">${String.fromCharCode(97 + i)}) ${s.statement || ''}</p>
                                                  <div class="flex gap-x-6">
                                                      <label class="flex items-center cursor-pointer"><input type="radio" name="q${globalIndex}-s${i}" value="true" class="mr-2 h-4 w-4"> Đúng</label>
                                                      <label class="flex items-center cursor-pointer"><input type="radio" name="q${globalIndex}-s${i}" value="false" class="mr-2 h-4 w-4"> Sai</label>
                                                  </div>
                                              </div>`;
                                 });
                                 groupHTML += `</div>`;
                                 break;
                            case 'short-answer':
                                groupHTML += `<input type="text" name="q${globalIndex}" class="mt-1 block w-full md:w-1/2 border border-slate-300 rounded-lg shadow-sm py-2.5 px-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" placeholder="Nhập đáp án của bạn...">`;
                                break;
                            case 'essay':
                                groupHTML += `<textarea name="q${globalIndex}" class="mt-1 block w-full border border-slate-300 rounded-lg shadow-sm py-2.5 px-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" rows="5" placeholder="Nhập câu trả lời tự luận của bạn..."></textarea>`;
                                break;
                        }
                        groupHTML += `</div><div id="q-${globalIndex}-feedback" class="mt-4"></div></div>`;
                    });
                    groupHTML += `</div>`;
                    studentQuizContainer.innerHTML += groupHTML;
                });
               
                if (window.MathJax && typeof window.MathJax.typesetPromise === 'function') {
                    MathJax.typesetPromise([studentQuizContainer]);
                }
            }
           
            async function generatePerformanceReview(allAnswersData) {
                const feedbackContainer = document.getElementById('ai-feedback-container');
                if (!feedbackContainer || !ai) return null;
                feedbackContainer.classList.remove('hidden');
                feedbackContainer.innerHTML = `
                    <div class="bg-white p-6 rounded-xl shadow-lg">
                        <h3 class="text-xl font-bold text-slate-800 mb-4">📝 Phân Tích & Gợi Ý Từ Trợ Lý AI</h3>
                        <div id="ai-feedback-loader" class="text-center py-6">
                            <svg class="animate-spin mx-auto h-10 w-10 text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                            </svg>
                            <p class="mt-3 text-slate-600">AI đang phân tích bài làm của bạn...</p>
                        </div>
                        <div id="ai-feedback-summary" class="hidden prose prose-sm max-w-none"></div>
                        <div id="ai-feedback-details" class="hidden mt-4 space-y-2"></div>
                    </div>
                `;
               
                const loader = document.getElementById('ai-feedback-loader');
                const summaryDiv = document.getElementById('ai-feedback-summary');
                const detailsDiv = document.getElementById('ai-feedback-details');
                const incorrectAnswers = allAnswersData.filter(a => !a.isCorrect);
                if (incorrectAnswers.length === 0) {
                    feedbackContainer.innerHTML = `
                        <div class="bg-white p-6 rounded-xl shadow-lg text-center">
                            <h3 class="text-xl font-bold text-green-600">🎉 Chúc mừng!</h3>
                            <p class="mt-2 text-slate-700">Bạn đã trả lời đúng tất cả các câu hỏi. Làm tốt lắm!</p>
                        </div>
                    `;
                    return { overallFeedback: { summary: "Xuất sắc! Học sinh đã đã trả lời đúng tất cả các câu hỏi." } };
                }
                const summaryPrompt = `Bạn là một trợ lý giáo viên, nói tiếng Việt. Dựa vào tóm tắt các câu trả lời sai của học sinh, hãy đưa ra một nhận xét tổng quan ngắn gọn (khoảng 3-4 câu) về năng lực của học sinh, bao gồm điểm mạnh (suy luận từ các câu làm đúng), điểm yếu (dựa trên các câu sai) và một vài gợi ý ôn tập chung. Lời văn phải khích lệ, rõ ràng. Dùng **...** để in đậm các thuật ngữ quan trọng.
                Tóm tắt lỗi sai:
                ${JSON.stringify(incorrectAnswers.map(a => ({ cau: a.questionNumber, loai: a.type, cauHoi: a.question.substring(0, 50) + '...' })), null, 2)}`;
                try {
                    const response = await ai.models.generateContent({
                        model: "gemini-2.5-flash",
                        contents: summaryPrompt
                    });
                    summaryDiv.innerHTML = formatAIText(response.text);
                    loader.classList.add('hidden');
                    summaryDiv.classList.remove('hidden');
                    detailsDiv.classList.remove('hidden'); 
                } catch (e) {
                    console.error("Lỗi khi lấy nhận xét tổng quan:", e);
                    summaryDiv.innerHTML = '<p class="text-red-600">Lỗi khi tạo nhận xét tổng quan.</p>';
                    loader.classList.add('hidden');
                    summaryDiv.classList.remove('hidden');
                }
               
                const summaryForSheet = summaryDiv.innerText.substring(0, 200) + "...";
                return { overallFeedback: { summary: summaryForSheet } };
            }
            async function handleSubmit() {
                if (isSubmitted) return;
                isSubmitted = true;
                clearInterval(timerInterval);
                
                document.querySelectorAll('input, textarea').forEach(input => input.disabled = true);
                submitBtn.classList.add('hidden');
                postSubmitOptions.classList.remove('hidden');
                if (retriesLeft > 0) {
                    retryBtn.classList.remove('hidden');
                } else {
                    retryBtn.classList.add('hidden');
                }

                const proctoringDataString = JSON.stringify(proctoringLog);

                let totalStudentScore = 0;
                let totalCorrectAnswers = 0;
                let allAnswersData = [];
                const questionCounts = quizData.reduce((acc, q) => {
                    const type = q.mappedType;
                    acc[type] = (acc[type] || 0) + 1;
                    return acc;
                }, {});
                
                quizData.forEach((item, index) => {
                    let questionNumber = index + 1;
                    let answerData = { questionNumber, type: item.type };
                    switch (item.mappedType) {
                        case 'multiple-choice':
                            const selectedOption = document.querySelector(`input[name="q${index}"]:checked`);
                            const isCorrectMC = selectedOption ? parseInt(selectedOption.value) === item.correctAnswerIndex : false;
                            if (isCorrectMC) {
                                totalCorrectAnswers++;
                                if (questionCounts['multiple-choice'] > 0) {
                                   totalStudentScore += quizOptions.scoring.mc / questionCounts['multiple-choice'];
                                }
                            }
                            answerData.question = item.question;
                            answerData.options = item.options;
                            answerData.yourAnswer = selectedOption ? String.fromCharCode(65 + parseInt(selectedOption.value)) : "Không trả lời";
                            answerData.correctAnswer = String.fromCharCode(65 + item.correctAnswerIndex);
                            answerData.isCorrect = isCorrectMC;
                            break;
                        case 'true-false':
                            let correctStatementsCount = 0;
                            let yourAnswerPattern = [];
                            let correctAnswerPattern = [];
                            let details = [];
                            item.statements.forEach((s, i) => {
                                const selectedTF = document.querySelector(`input[name="q${index}-s${i}"]:checked`);
                                const studentChoice = selectedTF ? selectedTF.value === 'true' : null;
                                const isStatementCorrect = studentChoice === s.is_correct;
                               
                                if (isStatementCorrect) correctStatementsCount++;
                               
                                yourAnswerPattern.push(studentChoice === null ? '?' : (studentChoice ? 'Đ' : 'S'));
                                correctAnswerPattern.push(s.is_correct ? 'Đ' : 'S');
                                details.push({ statement: s.statement, yourChoice: studentChoice === null ? 'Không trả lời' : (studentChoice ? 'Đúng' : 'Sai'), correctChoice: s.is_correct ? 'Đúng' : 'Sai', isCorrect: isStatementCorrect });
                            });
                            
                            let scorePerTfQuestion = 0;
                            if (questionCounts['true-false'] > 0) {
                                scorePerTfQuestion = quizOptions.scoring.tf / questionCounts['true-false'];
                            }
                            let questionPoints = 0;
                            if (quizOptions.scoring.tfMethod === 'progressive') {
                                const progressivePoints = { 0: 0, 1: 0.1, 2: 0.25, 3: 0.5, 4: 1.0 };
                                questionPoints = progressivePoints[correctStatementsCount] * scorePerTfQuestion;
                            } else { // even
                                questionPoints = (correctStatementsCount / 4) * scorePerTfQuestion;
                            }
                            totalStudentScore += questionPoints;

                            if(correctStatementsCount === 4) totalCorrectAnswers++;
                            answerData.question = item.main_question;
                            answerData.yourAnswer = yourAnswerPattern.join('-');
                            answerData.correctAnswer = correctAnswerPattern.join('-');
                            answerData.isCorrect = correctStatementsCount === 4;
                            answerData.details = details;
                            break;
                       
                        case 'short-answer':
                            const saInput = document.querySelector(`input[name="q${index}"]`);
                            const studentAnswerRaw = saInput ? (saInput.value ?? '').trim() : "";
                            const correctAnswerRaw = (item.answer ?? '').toString().trim().replace(/\$/g, '');
                            let isCorrectSA = false;
                            const studentAnswerNormalized = studentAnswerRaw.replace(',', '.');
                            const correctAnswerNormalized = correctAnswerRaw.replace(',', '.');
                            if (studentAnswerNormalized.toLowerCase() === correctAnswerNormalized.toLowerCase()) {
                                isCorrectSA = true;
                            }
                             if (isCorrectSA) {
                                totalCorrectAnswers++;
                                if (questionCounts['short-answer'] > 0) {
                                   totalStudentScore += quizOptions.scoring.sa / questionCounts['short-answer'];
                                }
                            }
                            answerData.question = item.question;
                            answerData.yourAnswer = studentAnswerRaw || "Không trả lời";
                            answerData.correctAnswer = correctAnswerRaw;
                            answerData.isCorrect = isCorrectSA;
                            break;
                           
                        case 'essay':
                             const essayInput = document.querySelector(`textarea[name="q${index}"]`);
                             answerData.question = item.question;
                             answerData.yourAnswer = essayInput.value || "Không trả lời";
                             answerData.correctAnswer = item.answer;
                             answerData.isCorrect = null; // Needs manual grading
                             break;
                    }
                    allAnswersData.push(answerData);
                });
                
                const finalScore = totalStudentScore;
                
                let competencyAssessment = "Giáo viên không yêu cầu AI phân tích bài làm.";
                if (quizOptions.aiAssessment) {
                    const feedbackData = await generatePerformanceReview(allAnswersData);
                    if (feedbackData && feedbackData.overallFeedback && feedbackData.overallFeedback.summary) {
                        competencyAssessment = feedbackData.overallFeedback.summary;
                    } else {
                        competencyAssessment = "Có lỗi xảy ra trong quá trình AI phân tích bài làm.";
                    }
                }
                
                if (quizOptions.showAnswers) {
                    const totalQuestions = quizData.length;
                    resultContainer.innerHTML = `<div class="bg-white p-6 rounded-xl shadow-lg text-center">
                        <h3 class="text-2xl font-bold text-slate-800">KẾT QUẢ BÀI LÀM</h3>
                        <p class="mt-4 text-lg">Số câu đúng hoàn toàn: <span class="font-bold text-green-600">${totalCorrectAnswers}/${totalQuestions}</span></p>
                        <p class="text-2xl mt-2">Điểm (thang 10): <span class="font-bold text-blue-600">${finalScore.toFixed(2)}</span></p>
                        ${questionCounts['essay'] > 0 ? `<p class="text-sm text-gray-600 italic mt-1">Lưu ý: Điểm trên chưa bao gồm ${quizOptions.scoring.essay} điểm của phần Tự luận.</p>` : ''}
                    </div>`;
                    resultContainer.classList.remove('hidden');

                    allAnswersData.forEach((ans, index) => {
                        const questionCard = document.getElementById(`student-q-${index}`);
                        const feedbackIconDiv = document.getElementById(`q-${index}-feedback-icon`);
                        const feedbackDiv = document.getElementById(`q-${index}-feedback`);
                        if (!questionCard || !feedbackIconDiv || !feedbackDiv) return;

                        const iconHTML = ans.isCorrect === true
                            ? '<svg class="feedback-icon text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>'
                            : (ans.isCorrect === false ? '<svg class="feedback-icon text-red-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg>' : '');
                        feedbackIconDiv.innerHTML = iconHTML;

                        if (ans.type.includes('multiple-choice')) {
                            const studentChoice = ans.yourAnswer === "Không trả lời" ? -1 : ans.yourAnswer.charCodeAt(0) - 65;
                            const correctChoice = ans.correctAnswer.charCodeAt(0) - 65;
                            document.getElementById(`q-${index}-opt-label${correctChoice}`)?.classList.add('correct');
                            if (studentChoice !== -1 && studentChoice !== correctChoice) {
                                document.getElementById(`q-${index}-opt-label${studentChoice}`)?.classList.add('incorrect');
                            }
                        } else if (ans.type === 'true-false') {
                            const statementItems = questionCard.querySelectorAll('.statement-item');
                            ans.details.forEach((detail, i) => { if(statementItems[i]) { statementItems[i].classList.add(detail.isCorrect ? 'correct' : 'incorrect'); }});
                        }

                        if (quizOptions.showExplanation) {
                            feedbackDiv.innerHTML = `<button data-explain-index="${index}" class="explain-btn mt-4 flex items-center px-4 py-2 bg-blue-100 text-blue-800 text-sm font-semibold rounded-lg hover:bg-blue-200 transition-colors">
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                Xem giải thích
                            </button>`;
                        }
                    });
                    
                    document.querySelectorAll('.explain-btn').forEach(btn => {
                        btn.addEventListener('click', (e) => {
                            const button = e.currentTarget;
                            const index = parseInt(button.dataset.explainIndex, 10);
                            showExplanation(index, button);
                        });
                    });

                    if (window.MathJax) await window.MathJax.typesetPromise([studentQuizContainer]);
                } else {
                     resultContainer.innerHTML = `<div class="bg-white p-6 rounded-xl shadow-lg text-center"><h3 class="text-xl font-bold text-green-600">Nộp bài thành công!</h3><p class="mt-2 text-slate-700">Bạn đã hoàn thành bài làm. Kết quả sẽ được giáo viên công bố sau.</p></div>`;
                    resultContainer.classList.remove('hidden');
                }
                
                const formData = new FormData();
                formData.append('name', studentInfo.name);
                formData.append('class', studentInfo.class);
                formData.append('score', `${finalScore.toFixed(2)}/10`);
                formData.append('assessment', competencyAssessment);
                formData.append('timestamp', new Date().toLocaleString('vi-VN'));
                formData.append('examCode', correctExamCode);
                formData.append('monitoringLog', proctoringDataString);
                formData.append('answerDetails', JSON.stringify(allAnswersData));
               
                fetch(googleScriptUrl, { method: 'POST', body: formData})
                    .then(res => console.log("Successfully submitted to Google Sheet"))
                    .catch(err => console.error("Error submitting to Google Sheet:", err));
            }
           
            function startNewAttempt() {
                isSubmitted = false;
                proctoringLog = { thoatManHinh: 0, saoChep: 0, dan: 0, suKien: [] };
                const proctoringWidget = document.getElementById('proctoring-widget');
                if (proctoringWidget) {
                    proctoringWidget.classList.add('hidden');
                    document.getElementById('tab-switch-count').textContent = '0';
                    document.getElementById('copy-count').textContent = '0';
                    document.getElementById('paste-count').textContent = '0';
                }

                renderStudentQuiz();
                resultContainer.classList.add('hidden');
                document.getElementById('ai-feedback-container').classList.add('hidden');
                postSubmitOptions.classList.add('hidden');
                submitBtn.classList.remove('hidden');
                 if (quizOptions.timeLimit > 0) {
                    const timeInSeconds = quizOptions.timeLimit * 60;
                    startTimer(timeInSeconds, timerDisplay);
                }
                retriesLeft--;
                retriesDisplay.textContent = `Lượt làm lại còn: ${retriesLeft}`;
                window.scrollTo(0, 0);
            }
            studentInfoForm.addEventListener('submit', (e) => {
                e.preventDefault();
               
                const enteredCode = document.getElementById('exam-code').value.trim().toUpperCase();
                if (correctExamCode && enteredCode !== correctExamCode) {
                    alert('Mã đề không chính xác. Vui lòng kiểm tra lại!');
                    return;
                }
               
                studentApiKey = teacherApiKey;
                if (!studentApiKey) {
                    console.warn('Cảnh báo: Giáo viên chưa cấu hình API Key. Các tính năng AI sẽ không hoạt động.');
                }
       
                try {
                    if (studentApiKey) {
                       ai = new GoogleGenAI({ apiKey: studentApiKey });
                    }
                } catch(e) {
                    console.error("Lỗi khởi tạo Gemini API với key của giáo viên.", e);
                    alert("Cảnh báo: API Key của giáo viên không hợp lệ. Vui lòng báo cho giáo viên. Các tính năng AI sẽ không hoạt động.");
                    ai = null;
                }
                shuffleQuiz();
               
                studentInfo.name = document.getElementById('student-name').value;
                studentInfo.class = document.getElementById('student-class').value;
                loginModal.classList.add('hidden');
                studentQuizContainer.classList.remove('hidden');
                submitBtn.classList.remove('hidden');
               
                if (quizOptions.timeLimit > 0) {
                    const timeInSeconds = quizOptions.timeLimit * 60;
                    startTimer(timeInSeconds, timerDisplay);
                } else {
                    timerDisplay.textContent = "Không giới hạn";
                }
                retriesDisplay.textContent = `Lượt làm lại còn: ${retriesLeft}`;
                renderStudentQuiz();

                const proctoringWidget = document.getElementById('proctoring-widget');
                const tabSwitchCountEl = document.getElementById('tab-switch-count');
                const copyCountEl = document.getElementById('copy-count');
                const pasteCountEl = document.getElementById('paste-count');

                function updateProctoringUI() {
                    if (proctoringLog.thoatManHinh > 0 || proctoringLog.saoChep > 0 || proctoringLog.dan > 0) {
                        proctoringWidget.classList.remove('hidden');
                    }
                    tabSwitchCountEl.textContent = proctoringLog.thoatManHinh;
                    copyCountEl.textContent = proctoringLog.saoChep;
                    pasteCountEl.textContent = proctoringLog.dan;
                }

                // Disable Right Click
                document.addEventListener('contextmenu', e => e.preventDefault());

                // Track Tab Switching
                document.addEventListener('visibilitychange', () => {
                    if (document.hidden && !isSubmitted) {
                        proctoringLog.thoatManHinh++;
                        proctoringLog.suKien.push({ loai: 'chuyen_tab', thoiGian: new Date().toISOString() });
                        updateProctoringUI();
                    }
                });

                // Track Copying
                document.addEventListener('copy', () => {
                    if (isSubmitted) return;
                    proctoringLog.saoChep++;
                    proctoringLog.suKien.push({ loai: 'sao_chep', thoiGian: new Date().toISOString() });
                    updateProctoringUI();
                });

                // Track Pasting
                document.addEventListener('paste', () => {
                    if (isSubmitted) return;
                    proctoringLog.dan++;
                    proctoringLog.suKien.push({ loai: 'dan', thoiGian: new Date().toISOString() });
                    updateProctoringUI();
                });
            });
            
            submitBtn.addEventListener('click', handleSubmit);
            retryBtn.addEventListener('click', () => {
                shuffleQuiz();
                startNewAttempt();
            });
        </script>
    </body>
    </html>
    